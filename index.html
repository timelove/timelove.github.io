<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="每天进步一点！" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="ChicBian的博客">
<meta property="og:url" content="http://chicbian.com/index.html">
<meta property="og:site_name" content="ChicBian的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ChicBian的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://chicbian.com/"/>





  <title> ChicBian的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ChicBian的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2018/04/27/android之sophix热修复/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/27/android之sophix热修复/" itemprop="url">
                  android之sophix热修复
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-27T10:16:51+08:00">
                2018-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="热修复概述"><a href="#热修复概述" class="headerlink" title="热修复概述"></a>热修复概述</h3><p>近 2 年来，热修复技术飞速发展。毕竟每次一个小版本的更新都要通过发布 apk 来实现，这样用户使用感可以说也是非常差了。怎么让客户不去重新下载一个 apk 而实现一个小版本或者一次小 bug 的修复，因此，热修复应运而生。</p>
<p>特别是 android studio 2.0 版本后 推出了 Instant Run 这个功能，关于 Instant Run 可以看 <a href="https://blog.csdn.net/guolin_blog/article/details/51271369" target="_blank" rel="external">郭大的博文</a>。从此，各种热修复热更新技术相继出现，国内比较成熟的主流 APP 都拥有自己的热修复技术，像支付宝、QQ、微信、美团等。</p>
<p>之前的热修复一般只支持代码热修复，而不支持资源热修复。代码热修复只是针对一些逻辑性错误的代码修改，到了后面又相继出现资源热修复，以及 so 热修复。本文主要是说阿里的 sophix ，所以就拿阿里的各版本热修复来说明比较。具体看下图：<img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr0ouo0gdj20hj0hzdgt.jpg" alt=""></p>
<p>基本可以看清楚，阿里从 Andfix 到最新的 Sophix 正在逐步完善。</p>
<p>而本文就将介绍，如何在 Android 项目中集成 Sophix 以及 如何使用Sophix。</p>
<h3 id="Sophix-集成和准备"><a href="#Sophix-集成和准备" class="headerlink" title="Sophix 集成和准备"></a>Sophix 集成和准备</h3><ol>
<li><h5 id="集成准备"><a href="#集成准备" class="headerlink" title="集成准备"></a>集成准备</h5><p>工具：android studio </p>
<p>环境：jdk 1.8</p>
<p>找到项目的 build.gradle 直接添加 maven 仓库地址：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">repositories &#123;</div><div class="line">   maven &#123;</div><div class="line">       url <span class="string">"http://maven.aliyun.com/nexus/content/repositories/releases"</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后找到 app 的 gradle 添加版本依赖：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.aliyun.ams:alicloud-android-hotfix:3.2.2'</span></div></pre></td></tr></table></figure>
<p>点击一波 sync now，完成配置。</p>
</li>
</ol>
<ol>
<li><h4 id="权限说明"><a href="#权限说明" class="headerlink" title="权限说明"></a>权限说明</h4><p>Siphix 需要用到 4 个基本权限：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;! -- 网络权限 --&gt;</div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.INTERNET"</span> /&gt;</div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span> /&gt;</div><div class="line">&lt;! -- 外部存储读权限，调试工具加载本地补丁需要 --&gt;</div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.READ_EXTERNAL_STORAGE"</span>/&gt;</div></pre></td></tr></table></figure>
<p>第四个权限是属于 Dangerous Permissions，所以需要在 android 6.0 的版本以上进行动态权限获取。</p>
</li>
<li><h4 id="混淆配置"><a href="#混淆配置" class="headerlink" title="混淆配置"></a>混淆配置</h4><p>需要在 proguard-rules.pro 混淆文件中加入混淆代码</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#hotfix</div><div class="line">-keep class com.taobao.sophix.**&#123;*;&#125;</div><div class="line">-keep class com.ta.utdid2.device.**&#123;*;&#125;</div><div class="line">#防止inline</div><div class="line">-dontoptimize</div><div class="line">-keepclassmembers class com.zyue.zyueapp.base.BaseApplication &#123;</div><div class="line">    public &lt;init&gt;();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><h4 id="Sophix-的稳健初始化方式"><a href="#Sophix-的稳健初始化方式" class="headerlink" title="Sophix 的稳健初始化方式"></a>Sophix 的稳健初始化方式</h4><p>本文采用 Sophix 的最新版本初始化方式，该方法显得更加简单明了，而且跟原始的自己所加载的 Application 不会造成冲突。这样使得原先真正的 Application 也可以热修复，并且减少了补丁预加载的时间，同时还兼容了 Aandroid 8.0 以后的版本。</p>
<p>具体就是要我们自己加入一个类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.my.pkg;</div><div class="line"><span class="keyword">import</span> android.app.Application;</div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.support.annotation.Keep;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> com.taobao.sophix.PatchStatus;</div><div class="line"><span class="keyword">import</span> com.taobao.sophix.SophixApplication;</div><div class="line"><span class="keyword">import</span> com.taobao.sophix.SophixEntry;</div><div class="line"><span class="keyword">import</span> com.taobao.sophix.SophixManager;</div><div class="line"><span class="keyword">import</span> com.taobao.sophix.listener.PatchLoadStatusListener;</div><div class="line"><span class="keyword">import</span> com.my.pkg.MyRealApplication;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * Sophix入口类，专门用于初始化Sophix，不应包含任何业务逻辑。</div><div class="line"> * 此类必须继承自SophixApplication，onCreate方法不需要实现。</div><div class="line"> * 此类不应与项目中的其他类有任何互相调用的逻辑，必须完全做到隔离。</div><div class="line"> * AndroidManifest中设置application为此类，而SophixEntry中设为原先Application类。</div><div class="line"> * 注意原先Application里不需要再重复初始化Sophix，并且需要避免混淆原先Application类。</div><div class="line"> * 如有其它自定义改造，请咨询官方后妥善处理。</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SophixStubApplication</span> <span class="keyword">extends</span> <span class="title">SophixApplication</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String TAG = <span class="string">"SophixStubApplication"</span>;</div><div class="line">    <span class="comment">// 此处SophixEntry应指定真正的Application，并且保证RealApplicationStub类名不被混淆。</span></div><div class="line">    <span class="meta">@Keep</span></div><div class="line">    <span class="meta">@SophixEntry</span>(MyRealApplication.class)</div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RealApplicationStub</span> </span>&#123;&#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">attachBaseContext</span><span class="params">(Context base)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.attachBaseContext(base);</div><div class="line"><span class="comment">//         如果需要使用MultiDex，需要在此处调用。</span></div><div class="line"><span class="comment">//         MultiDex.install(this);</span></div><div class="line">        initSophix();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initSophix</span><span class="params">()</span> </span>&#123;</div><div class="line">        String appVersion = <span class="string">"0.0.0"</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            appVersion = <span class="keyword">this</span>.getPackageManager()</div><div class="line">                             .getPackageInfo(<span class="keyword">this</span>.getPackageName(), <span class="number">0</span>)</div><div class="line">                             .versionName;</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">final</span> SophixManager instance = SophixManager.getInstance();</div><div class="line">        instance.setContext(<span class="keyword">this</span>)</div><div class="line">                .setAppVersion(appVersion)</div><div class="line">                .setSecretMetaData(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>)</div><div class="line">                .setEnableDebug(<span class="keyword">true</span>)</div><div class="line">                .setEnableFullLog()</div><div class="line">                .setPatchLoadStatusStub(<span class="keyword">new</span> PatchLoadStatusListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoad</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> mode, <span class="keyword">final</span> <span class="keyword">int</span> code, <span class="keyword">final</span> String info, <span class="keyword">final</span> <span class="keyword">int</span> handlePatchVersion)</span> </span>&#123;</div><div class="line">                        <span class="keyword">if</span> (code == PatchStatus.CODE_LOAD_SUCCESS) &#123;</div><div class="line">                            Log.i(TAG, <span class="string">"sophix load patch success!"</span>);</div><div class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == PatchStatus.CODE_LOAD_RELAUNCH) &#123;</div><div class="line">                            <span class="comment">// 如果需要在后台重启，建议此处用SharePreference保存状态。</span></div><div class="line">                            Log.i(TAG, <span class="string">"sophix preload patch success. restart app to make effect."</span>);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;).initialize();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这边的初始化动作一定要放在 attachBaseContext 中进行，onCreate 不需要自行实现。并且如果项目中因为方法类过多，超过 64K ,需要使用到MultiDex，就必须把该方法放到初始化动作之前，也就是上类中注释掉的部分。</p>
<p>在这个类中，关键一点要加入自己写的 Application.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Keep</span></div><div class="line">  <span class="meta">@SophixEntry</span>(MyRealApplication.class)</div><div class="line">  <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RealApplicationStub</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>这里的 MyRealApplication 就换成自己写的 Application。</p>
<p>为了防止自己写的 Application 和 这个类混淆，在 proguard 文件中加入以下混淆代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-keepclassmembers class com.my.pkg.MyRealApplication &#123;</div><div class="line">    public &lt;init&gt;();</div><div class="line">&#125;</div><div class="line"># 如果不使用android.support.annotation.Keep则需加上此行</div><div class="line"># -keep class com.my.pkg.SophixStubApplication$RealApplicationStub</div></pre></td></tr></table></figure>
<p>最后，将 AndoridManifest.xml 中的 application 的 name 换成这个类名。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;application</div><div class="line">       android:name=<span class="string">"com.my.pkg.SophixStubApplication"</span></div><div class="line">       ... ...&gt;</div><div class="line">       ... ...</div></pre></td></tr></table></figure>
<p><strong>最为关键的一步：</strong></p>
<p>到此处，稳健接入初始化，还差一个步骤，就是进行补丁下拉，也就是 queryAndLoadNewPatch 这个方法的调用。我个人是直接放到了自己写的 Application onCreate中，不建议放到其他方法类下。</p>
<p>或者自己写个线程进行间隔拉取补丁进行热修复。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">super</span>.onCreate();</div><div class="line">     SophixManager.getInstance().queryAndLoadNewPatch();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>到这里，这样除了一个 setSecretMetaData 没有配置，其他都配置 OK 了。setSecretMetaData 里面的参数，需要在阿里控制台进行其他操作才能进行。</p>
<p>若有不理解处，可以具体查看官方<a href="https://help.aliyun.com/document_detail/69874.html?spm=a2c4g.11186623.6.549.95pgtc" target="_blank" rel="external">官方技术文档</a>。</p>
</li>
</ol>
<h3 id="Sophix-具体使用"><a href="#Sophix-具体使用" class="headerlink" title="Sophix 具体使用"></a>Sophix 具体使用</h3><ol>
<li><p>首先进入阿里云的<a href="https://emas.console.aliyun.com/" target="_blank" rel="external">移动研发平台</a>。找到移动热修复功能点，或者搜索。</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2biv0bcj20520ktaaj.jpg" alt=""></p>
</li>
<li><p>点击添加产品</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2d6jmgwj20a405bdfn.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2ed8vhej20h109a0su.jpg" alt=""></p>
</li>
<li><p>填写产品信息，创建完成后，点击该产品进入。</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2g6hw8fj20hy0bidg0.jpg" alt=""></p>
</li>
<li><p>点击添加应用</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2h3u34ij20tk0f0gm9.jpg" alt=""></p>
</li>
<li><p>app 名称和包名跟自己项目的保持一致，然后创建。</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr65ff7mrj21320bqq3m.jpg" alt=""></p>
<p>这里可以看到项目中所需要的 AppSecret，还有2 个参数，就点击下载 aliyun-emas-services.json，打开找      到 IDSECRET ，APPSECRET ，RSASECRET 这 3 个参数，写入到一开始稳健接入 SophixStubApplication 类中。主要设置为 setSecretMetaData 方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> SophixManager instance = SophixManager.getInstance();</div><div class="line">        instance.setContext(<span class="keyword">this</span>)</div><div class="line">                .setAppVersion(appVersion)</div><div class="line">                .setSecretMetaData(<span class="string">"IDSECRET"</span>, <span class="string">"APPSECRET "</span>,<span class="string">"RSASECRET"</span>)<span class="comment">//填写密钥和ID</span></div><div class="line">                .setEnableDebug(<span class="keyword">true</span>)</div><div class="line">                .setEnableFullLog()</div><div class="line">                .setPatchLoadStatusStub(<span class="keyword">new</span> PatchLoadStatusListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoad</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> mode, <span class="keyword">final</span> <span class="keyword">int</span> code, <span class="keyword">final</span> String info, <span class="keyword">final</span></span></span></div><div class="line">                    <span class="keyword">int</span> handlePatchVersion) &#123;</div><div class="line">                        <span class="keyword">if</span> (code == PatchStatus.CODE_LOAD_SUCCESS) &#123;</div><div class="line">                            Log.i(TAG, <span class="string">"sophix load patch success!"</span>);</div><div class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == PatchStatus.CODE_LOAD_RELAUNCH) &#123;</div><div class="line">                            <span class="comment">// 如果需要在后台重启，建议此处用SharePreference保存状态。</span></div><div class="line">                            Log.i(TAG, <span class="string">"sophix preload patch success. restart app to make effect."</span>);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;).initialize();</div></pre></td></tr></table></figure>
<p><strong>到这一步完成，Sophix 的初始化才算真正完成。</strong></p>
</li>
<li><p>然后点击移动热修复，点击功能。</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr2ipaoggj21b70art9f.jpg" alt=""></p>
<p>点击添加版本</p>
<p> <strong>注意：</strong>这里的版本号必须跟项目中的 versionName 保持一致，否则项目拉取补丁会失败。</p>
<p>到这个就可以上传自己项目的补丁了。</p>
</li>
<li><p>补丁制作</p>
<p>是需要下载官方的一个工具，然后进行补丁打包。再将该补丁上传到该版本下。</p>
<p>生成补丁看这里，<a href="https://help.aliyun.com/document_detail/53247.html?spm=a2c4g.11186623.6.550.JPid86" target="_blank" rel="external">生成补丁</a>.</p>
<p><strong>又要注意了</strong>：这里的补丁名称不要乱修改，就得用这个工具生成的。</p>
<blockquote>
<p>到了此处，终于到了补丁发布了。折腾这么久，听着流泪，闻着伤心。</p>
</blockquote>
</li>
<li><p>上传完补丁后，点击详情，进入该补丁界面。</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fqr615exizj21570js76c.jpg" alt=""></p>
<p>这个右侧有一个<strong>扫码验证</strong>补丁：点击下载 Sophix自带的一个自测 apk，安装在自己手机上，可以扫码来验证补丁是否有效，有效后，可以点击，新建发布。然后打开手机上的 app，就可以坐等热修复了。​​​​</p>
</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>到这里，Sophix 热修复的功能就基本结束了。其中，小编自己踩的坑也都表明了注意，要是还有其他问题可以访问官方技术文档，或者进行问题搜索都可以得到一个满意的答复。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2018/01/09/2017总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/09/2017总结/" itemprop="url">
                  2017总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-09T14:56:22+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="2017-年终总结"><a href="#2017-年终总结" class="headerlink" title="2017 年终总结"></a>2017 年终总结</h3><p>话说已经 2018 年 1 月 9 号，我才想起写总结，希望还是能搭上总结大军的车，老司机，带带我。</p>
<p>2017年发生了很多事情，从最近的李小璐出轨，再到前段时间中国最大庞氏骗局『钱包网』CEO 自首。各种大事件充斥在社会的每一个角落。网络流行语，也从”老司机，带带我”，“打工是不可能打工的”这些骚话到最近的”做头发“，作为常年一个混迹 A 站的我来说，洒洒水啦。技术角度来讲，去年就预热的 python 各种火热，我也蹭了一哈子，给自己的技术栈增加一点东西。</p>
<p>就不扯那么多废话了，回归正题。2017 对于我自己来说也发生了很多事情。</p>
<ul>
<li><p>为自己买了一部 i7 以及一台足够玩各类游戏和兼容工作的台式机，价格一般，但是我很满足了。</p>
</li>
<li><p>买了个 kindle ，里面的一本『巨人的陨落』我才看了一半，羞愧。</p>
</li>
<li><p>买了 5 本实体书，其中包括 2 本英文书：『了不起的盖茨比』和『老人与海』。本来打算先从基础的『老人与海』看完，再看比较复杂的『了不起的盖茨比』，不过暂时还没有实施。看完了三毛的『送你一匹马』和大冰去年的新书『我不』。杨绛先生的『我们仨』，看了开头的大部分，没有接下去看的勇气，正值青年的我，暂时可能还没法理解其中含义，不知道我到  30 岁去看是否有其他感受。也许之后不太会主动去读大冰的书了，我连续 3 年读了大冰的 3 新书，不可否认，我喜欢书中的故事，喜欢书中描述的世界，但是终究现实还是现实，逃不脱，解不开。</p>
<p>那天看视频，其中一段插入了 三毛 打电话给荷西的录音。开口的瞬间，我震惊了，感觉三毛的声音好符合她的性格，怎么会有这样的声音。声音透露着温柔，温柔中又透露着洒脱，反正以我的文采并不能描述出来。从三毛的书中不难看出其实三毛的个人世界是有多纷乱和精彩，从小时候的疾病，到长大后的抑郁。我不清楚这样一段录音发生在什么样的情况下，也不清楚是发生在她人生中的哪一个阶段。但是我又懂了，怪不得，怪不得，那么多人去追求了三毛，哪怕是这样声音放到这个21世纪的世界也怕是极其具有诱惑力，更何况她那更有趣的灵魂。这里附上<a href="http://www.iqiyi.com/w_19rr77vipd.html" target="_blank" rel="external">三毛珍贵录音</a></p>
</li>
<li><p>自己学会了搭建博客，搭建翻墙 VPN ，也自学了 python 语言。在本职 android 上也学习了很多新技术，了解了更多的技术栈，以及对技术圈有了个大致了解。</p>
</li>
<li><p>本来准备年中的时候跟前公司申请涨薪，但是沟通稍微有点失败，加上其他各种各种原因，离职。现在在新公司 2 个多月，比较满意自己现在的工作状态。希望以后再接再厉！</p>
</li>
<li><p>娱乐上说，卸载了 LOL ，下载了「绝地求生」，俗称 ‘吃鸡’ ，很嗨。为啥卸载 LOL ，可以看我上一篇文章。而且我发现自从没玩 LOL ，整个人戾气少了很多，人更加平和了。</p>
</li>
<li><p>锻炼，在夏天最热的 3 个月，每周坚持 2-3 次的外出 5 km 跑步，跑回家一身汗。就那段时间，我的晨脉特别健康状态。瞅瞅也好久没运动，所以买了个健身轮，天天在家做几组，拉练拉练。毕竟身体才是革命的本钱啊！</p>
</li>
<li><p>在快年末的时候，家里去了一只小狗，我给叫「丢丢」，小狗没尾巴，是斗牛犬的混种，听家里人说很可爱。租房地方不大，不然我就可以带到自己这边养起了，小小的遗憾呐。</p>
</li>
<li><p>唯一的大遗憾的就是没能攒下积蓄，这点就比较蛋疼了，希望明年可以有所突破。</p>
</li>
</ul>
<h3 id="展望-2018"><a href="#展望-2018" class="headerlink" title="展望 2018"></a>展望 2018</h3><p>不知道 2018 会如何，过了春节，就到了我的本命年了，希望在本命年，在工作上有所突破了，工资涨啊涨，其他就身体健康最为关键了。然后就是学习，学习，学习。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/10/28/5年之痒，再见了LOL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/28/5年之痒，再见了LOL/" itemprop="url">
                  5年之痒，再见了LOL
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-28T22:51:24+08:00">
                2017-10-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="再见了，LOL"><a href="#再见了，LOL" class="headerlink" title="再见了，LOL"></a>再见了，LOL</h3><p>2012 年，某周末晚上，一家网吧，是的网吧，那时候还跟没网咖的概念。疯狂 CF ,一把 AN94 突突突 ，秀翻全场。临近 9 点，CF 战队开会，大家停止游戏统一进 YY 。别问为啥我这穷屌丝居然还战队开会，木办法，那时候的 CF 相对来说还是很公平的，网吧基本有一半甚至三分之二都在打 CF ，本人这种混子有个战队不是很正常吗？嗯？这时候一般我会打开一个叫做 QQ 斗地主的游戏，疯狂叫地主（以前斗地主只要能叫，绝对不怂）。</p>
<p>However，那天我正巧，牌运很差，送我的豆子都输光啦。好气，凭我的技术，一般这 4 次送豆都能玩好久好伐。</p>
<p>此时开会还没结束，我鬼使神差的打开了一款叫做英雄联盟的游戏，嗯，这游戏。我完全不知道是啥，也不知道这个游戏是干嘛的。直接登录注册，随手一个 ID ：急哦XXX。啥特么教程，我瞅都不带瞅的，直接点了个大师你懂么？进入游戏，一把人机就搞了起来。然后被这游戏搞的头大，怎么操作，啥子 技能，我的天呐，真难啊，sb 游戏，然后退出了游戏。嗯，大概这就是我与 LOL 的第一次美好邂逅。呵呵，当时估计那把队友都是 mmp。虽然当时是人机，但是对于我这种新手还是很难的好吧。</p>
<p> 第二次，战队开会，没错，第二次。我一看周围一个大兄弟也在玩，哎，这游戏有点意思啊，里面也登游戏进去。然后又是一把人机，全场一顿寒冰到处溜达，然后就赢了，哎，莫名其妙，还有点胜利的赶脚。不错哦，然后我又疯狂怼了几把人机。接着我就点开了一个奇怪的游戏模式，匹配模式。随之而来的所以一波又一波黑屏，难受，mmp，垃圾游戏，拉闸。</p>
<p>第三次，嗯，不是战队开会了，实在是那天打爆破打累着，就冲 LOL 这画质去放松下也是好的啊。其实是特么那个垃圾网吧网速很差，打游戏倒是很稳定，但是网速奇差无比，看个视频卡成 shi , 又不想这么早回去。所以准备点开一波 LOL 来个美滋滋的战斗。不巧，登上游戏，发现我姐也在玩，嘿嘿，玩游戏，啥子最重要，开黑，而不是单机。当初我姐也是愿意带我这个坑也是真爱啊。毕竟我特么坑成 shi。也感谢当初那些队友，没咋喷我，其实我当初也是懒得关注聊天记录区，喷都喷吧，小 case 啦。不巧，那天赵信，没错，信爷，又称菊花信。对着敌人菊花一阵 3 连捅直接要你狗命。不吹不黑，虽然是第一次玩菊花信，但是那天打出了风采，第一次超神，我滴天。个人感觉也是那时候彩笔还是很多的，不对，是新手还是很多，纯属是因为赵信当初那个版本太强了，见谁怼谁，超神，美滋滋。后来又仗着脸皮厚让我姐带着我飞起来，又是一顿菊花信，victory，胜利的喜悦，大概就是电竞的魅力吧。是的，当初就体验过电竞的魅力了，很嗨。</p>
<p>2017 年 10 月 28 日 10 点 33 分，我犹豫很久，想了又想，还是决定卸载掉她了。是的 RNG 输给了 SKT ，梦想破碎了，冠军不冠军又如何。RNG 承载了我们这一代 LOLer 的很多梦想。已经 S7 了，记得以前在一区打，要是周末，基本进去都是要排队，现在呢，基本上是秒进去，打个排位都要排好久。事实说明，现在玩 LOL 的人确实不多了。昨天 RNG vs SKT ，打的很精彩，说句实话， UZI 今年的状态就应该拿冠军，但是这是一个团队游戏，而现在的版本，ADC 前期根本发力不了。说白了，这游戏很吃团队。一直很支持 UZI，一手 VN 终究秀，把这个当年 17 岁的少年推上了世界第一 ADC 的座位。不是狗吹，但是是狗粉。比赛就不多说了。要是看过当年 S3 皇族打 SKT 1 那场决赛，就可以知道，当年的 5 个人，上单神超，中单五五开，打野 lucky，下路 UZI 和 Tabe。基本线上能力超级强，绝对的优势，但是就是当年的中国 LOL 没有教练，也没有运营思维，输在这里，所以大家说的 0-3 ，我上我也行也是有道理的。现在的中国上单只有 WE 的 957 还可以跟韩国上单一站，其他上单从来都是抗压或者被打出 shi 。</p>
<p>真正的开始玩 LOL ，是进大学，和宿舍的哥几个一起玩的。有天我乐看到我电脑上在下 LOL 。哎，你也玩这个，我们最近也在玩，一起哇。就酱，我们开始了每天 4 黑的日子，甚至后来，dota 大神，我熹也加入了我们，一度壮大到 5 黑。记得刚开始一起打人机的时候，我们 4 个连人机有时候都打不动，什么上中野下辅助，这些位置也是根本不了解的，唯有一腔热血，怼。渐渐地，大家技术都有了提升了，开始会了一些基本套路，比如 5 个人蹲草丛，四一分带拆塔赢， AP 中单 JS……我们对每个位置也有了足够的了解。我一般玩上单，补位其他，菊哥一般打野和辅助，我乐，专注于 ADC，我胖专注于中单，偶尔切换到其他路换换口味。</p>
<p>从此，6 个单身的汉子，一下课就是直奔宿舍，打开电脑，约战裁决之队。唯有大哥很坚挺，打开电脑，带上耳机，进入到自己的世界，任凭我们喧嚣和吵闹，很包容。我想我们 5 黑的道路上少不了大哥的包容，给我们创造了这样一个美好的环境。一到周末，开黑到 3 ，4 点那都不是事儿。所以，感谢大哥当年不杀之恩。在大一，每天可以打个十几把 LOL 都不带喘气的，洒洒水。</p>
<p>到了大二，我胖把我们带人了剑三的世界，然后我发现，我去这游戏不太适合我，== 。然后我每天还是坚持打 LOL ，连续好久都是我一人的独行 LOL，然后和发小一起决战其他区或者和我刘一起双排。偶尔宿舍还是一起约战到裁决之队。 来一波开黑，很燃。</p>
<p>曾经的游戏巅峰，大概是我们 3  个人硬拖到后期，3 打 5 赢了。当时对面和我们技术都差不多，到了后面硬是被当时我胖的旋转卡特给完美收割。有图有真相：</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fkyx6d8ly4j20kk0iigq9.jpg" alt=""></p>
<p>电竞胜利的喜悦是很美妙的，当年这把赢的更是美妙中的美妙。每一个大劣势局能赢都是队友们的互相鼓励和坚持，每一个大优势输的局肯定是浪输的。可以看到，当年的打野蛋刀充斥在野区，当年的饮血剑并不是唯一被动（依稀记得有一把被对面瑞文5把饮血剑支配的恐惧），当年的轻语还是那么帅的标记，当年的鞋子可以附魔，当年的兰顿也不是如今的兰顿……而如今的游戏也不是当年的那个 LOL 。</p>
<p>全华班的 RNG 输了，我感觉我的 LOL 也输了。因此我犹豫好久决定卸载掉她，将她变成一个美好的回忆，以后除非哥几个约战，将不再以召唤师的名义进入召唤师峡谷进行战斗。</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fkyxhcwgu4j20dr09qdg8.jpg" alt=""></p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fkyxirethqj20dv09waa7.jpg" alt=""></p>
<p>本来还有很多关于 LOL 的故事要写，但是写到此处，也不知道写些什么。</p>
<p>看到 RNG 最后一波死人的的时候，直接关掉直播，凉了。输了，不想再点开比赛去看 RNG 的失落。LOL 终究是一个游戏竞技，跟传统体育竞技存在差别。作为电竞时代的宠儿 LOL 也是要开始走下坡路的。</p>
<p>今年作为最有希望的一年，全华班还是倒在了 SKT 王朝之下，虽败犹荣。但是终究还是输，这就是电竞，很残忍，也很现实。也有说明天 WE 也许可以夺冠，是的，夺冠归夺冠，但是 WE 他毕竟不是全华班，承载不了我这个一个老 LOLer 追逐。同样也支持 WE，但是意义大不相同。</p>
<p>因此，考虑很久，还是决定卸载掉 LOL，微博屏蔽掉所以关于 LOL 的推送消息，知乎关掉 英雄联盟话题，以后就和 LOL 相忘于江湖了。</p>
<p>作为一个老玩家实在是适应不了 LOL 现在多变的模式了，多变的英雄更新，机制更新。每天有着满足于菜米油盐的工作，并不能时时刻刻来关注她了。也许有很多玩家跟我有一样的感触，当 RNG 输掉的那一刻，这个游戏对于我来说索然无味了。</p>
<p>LOL 承载了我 5 年多的青春，在这样一个完全公平的竞技环境下，完全是靠个人发挥和对游戏的理解进行战斗。在以前跟宿舍兄弟们，和哥们几个一起开黑的，一起吵闹，一起喧嚣的日子本来就一去不复返了了，为何我还在执着这个游戏，执着到 S7 全华班夺冠无望，确实该放下了。</p>
<p>对我来说，LOL 已经不仅仅是一个游戏，我从小玩的游戏不多，从小霸王时代到 PC端时代，玩过的网络竞技游戏屈指可数。以前玩 LOL 的我是玩上单，从来不怂，刚正面，现在反而玩 ADC 多，怂发育，托后期，到中后期给队伍保证足够的伤害。依稀还记得在网吧拿五杀得了杯咖啡的时光，这原本就是这个游戏的魅力所在。</p>
<p>也许很多人和我一样，从此再不玩 LOL 。</p>
<p>人生不仅仅是菜米油盐，还有 LOL。</p>
<p>人生不仅仅包含有 LOL，更有菜米油盐。</p>
<p>再见了我的 LOl ，再见了我的召唤师峡谷！</p>
<blockquote>
<p>本来还有很多话要说，但是无以言表，我不知道这对于一个中度 LOLer 到底有什么意义，但是我还是毅然决然地与她告别，也许大概以后再也不会玩一款游戏超过 5 年以上了，再也不会去研究一个游戏如此深刻，再也遇不到一帮志同道合的伙伴去玩这款游戏了。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/10/12/动态布局-GridLayout-Kotlin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/12/动态布局-GridLayout-Kotlin/" itemprop="url">
                  动态布局 GridLayout(Kotlin)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-12T15:59:20+08:00">
                2017-10-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><em>前言</em>:  最近项目中需求到一个功能,就是根据后台传过来的数据，在 Android 上进行一个自定义分屏。分屏区域是不定的,分屏区域的大小更是不定的，唯一定的分屏区域的形状肯定是长方形。那这里就想到如同 Excel 合并单元格的模式来进行动态布局。而由于最近 Kotlin 语言大火，本次直接使用到 Kotlin 语言进行实际开发。</p>
<h3 id="动态GridLayout的具体实现方式"><a href="#动态GridLayout的具体实现方式" class="headerlink" title="动态GridLayout的具体实现方式"></a>动态GridLayout的具体实现方式</h3><p>一般实现 GridLayout 都是在 xml 文件中进行配置,然后在 GridLayout 对里面的子控件一个一个的写。如果用这个来实现一个简单的计算器布局,估计很累。同样在具体需求下面,这样的每个都进行布局重写根本不符合我们所需要的功能。因此博主就想到,能不能让 GridLayout 子布局动态大小，而且还要为每个子布局设置属性等等,想想就头大不是么，相当复杂了可以说。</p>
<p>这里就想到一个好办法,就是把 GridLayout 看做一个田字格画布,比如说 3x4 的画布，那这个画布上面就有 12 个格子。跟表格类似。就跟在 Excel 上合并单元格一样，只要能合并单元格的区域就可以单独作为一个子区域。那这个单独的子区域上面可以防止任何组件，如：TextView,Button,Fragment….只要你能想到的控件,基本都可以放进去,然后实现深一步的业务。</p>
<h3 id="Kotlin-简介"><a href="#Kotlin-简介" class="headerlink" title="Kotlin 简介"></a>Kotlin 简介</h3><p>今天的 Google 大会上，已经正式提出将 Kotlin 语言作为 Android 的开发语言。可以说又是一个 Google 的亲儿子，以后肯定会成为 Android 开发的主流语言。其对于传统语言 Java 的优势这里我就不多累赘了，具体可以看知乎上大神些的回答：<a href="https://www.zhihu.com/question/37288009" target="_blank" rel="external">Kotlin 作为 Android 开发语言相比传统 Java 有什么优势？</a></p>
<p>总得来说，用 Kotlin 来开发就会变的很爽。但是毕竟是一个新出语言，市场上，还没有公司正式用该语言进行具体的开发步骤，基本都是大家进行一些个人开发。毕竟很多国内关于 Kotlin 的社区并不是很完善。</p>
<p>本编将在实际操作的过程中顺便介绍 Kotlin 的简单知识，希望对你有所帮助。如遇到不理解的地方，欢迎 Google ，基本上一个 Stackoverflow 社区可以解决你的一些问题(要是访问慢的话试试科学上网吧)。</p>
<h3 id="GridLayout-具体实现步骤"><a href="#GridLayout-具体实现步骤" class="headerlink" title="GridLayout 具体实现步骤"></a>GridLayout 具体实现步骤</h3><h5 id="1-动态布局设置"><a href="#1-动态布局设置" class="headerlink" title="1.动态布局设置"></a>1.动态布局设置</h5><p>首先我们在布局文件中放入一个 GridLayout 作为主布局，然后在代码中动态设置 GridLayout 的横向纵向数，以及每个格子的控件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">GridLayout</span></span></div><div class="line">       <span class="attr">android:id</span>=<span class="string">"@+id/grid_layout"</span></div><div class="line">       <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">       <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">     /&gt;</div></pre></td></tr></table></figure>
<p>然后通过代码获取屏幕的长宽，方便后面动态布局设置长宽属性。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> height = <span class="number">0</span>   <span class="comment">//屏幕高度</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> width = <span class="number">0</span>   <span class="comment">//屏幕宽度</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> mainX = <span class="number">3</span>       <span class="comment">//x轴格子数</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> mainY = <span class="number">4</span>        <span class="comment">//Y轴格子数</span></div></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">       <span class="comment">//获取手机屏幕高宽度</span></div><div class="line"><span class="keyword">val</span> wm: WindowManager = <span class="keyword">this</span>.windowManager</div><div class="line">height = wm.defaultDisplay.height</div><div class="line">width = wm.defaultDisplay.width</div><div class="line"></div><div class="line">grid_layout.columnCount = mainX <span class="comment">//设置gridlayout 横向格子</span></div><div class="line">grid_layout.rowCount = mainY   <span class="comment">//设置gridlayout 竖向格子</span></div></pre></td></tr></table></figure>
<p>这里我为了操作方便，是直接把 X 和 Y 轴格子数写死了，就是横向 3 个，竖向 4 个，也就说一共是一个 3 x 4 = 12 的表格。如下图：</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fkgdztrfn0j206307hjr5.jpg" alt="img"></p>
<p>这里我们可以根据坐标，已经占用的横纵两向的格子数来合并这些格子。</p>
<p>在手机上，坐标跟普通坐标系是有点反着的，既手机的左上角是坐标原点处，往下是 Y 轴延伸方向，往左是 X　轴延伸方向。请忽略我这个灵魂画手。</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fkge5jnxitj20c908jjr7.jpg" alt="手机屏幕坐标图"></p>
<p>那么现在我们只需要传入 4 个参数，既坐标点 x,y 以及各占用的格子数 xn，xn，就可以在这个 12 表格的 GridLayout 上面将布局画出来。</p>
<p> 每次都单独取一个布局元素</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> par = GridLayout.LayoutParams()   <span class="comment">//每个子布局单独获取,并分配区域</span></div></pre></td></tr></table></figure>
<p>分配好这个布局所占用的控件位置，以及占用表格大小</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">par.rowSpec = GridLayout.spec(y <span class="keyword">as</span> <span class="built_in">Int</span>, yn <span class="keyword">as</span> <span class="built_in">Int</span>)</div><div class="line">par.columnSpec = GridLayout.spec(x <span class="keyword">as</span> <span class="built_in">Int</span>, xn <span class="keyword">as</span> <span class="built_in">Int</span>)</div><div class="line"><span class="comment">//根据每个格子占用高宽来计算这个子布局的高宽</span></div><div class="line">par.height = height / mainY * yn</div><div class="line">par.width = width / mainX * xn</div></pre></td></tr></table></figure>
<p>如果有要在格子间加入线条的需求，可以设置各个子布局间的距离，然后统一设置整个布局背景，就是线条颜色，也可以在子布局中详细设置，这个就见仁见智了。具体需求具体操作。</p>
<p>因为有些格子是靠边的，所以并不需要靠边的一侧空出间隔，所以要进行一个简单的判断。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//判断子布局的上下左右是否为边界,是,就不留间隔.</span></div><div class="line">       <span class="keyword">if</span> (<span class="number">0</span> != y) &#123;</div><div class="line">           par.topMargin = <span class="number">1</span></div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span> (<span class="number">0</span> != x) &#123;</div><div class="line">           par.leftMargin = <span class="number">1</span></div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span> (mainX != (x + xn)) &#123;</div><div class="line">           par.rightMargin = <span class="number">1</span></div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span> (mainY != (y + yn)) &#123;</div><div class="line">           par.rightMargin = <span class="number">1</span></div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>接着把设置的布局元素设置为指定的控件，我这里因为功能需要，都统一成 FrameLayout，然后每个 FrameLayout 都设置一个单独的 Fragment ，方便在独立的 Fragment 中进行逻辑处理。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">t.layoutParams = par</div><div class="line"></div><div class="line">grid.addView(t, par)</div></pre></td></tr></table></figure>
<p>这里我们把这个设置子布局的内容，单独设立一个方法，方便之后的使用。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * 设置Fragment组件 跨多少行 跨多少列</div><div class="line">     * 这里不一样的要设置成 Fragment,其他各种组件都可以自己搭配</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> grid grid控件</div><div class="line">     * <span class="doctag">@param</span> t    fragment布局</div><div class="line">     * <span class="doctag">@param</span> x    组件横向轴开始的索引</div><div class="line">     * <span class="doctag">@param</span> y    组件纵向轴开始的索引</div><div class="line">     * <span class="doctag">@param</span> xn   组件横向拉升位置 就是占几列</div><div class="line">     * <span class="doctag">@param</span> yn   组件列向拉升位置</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setSpanRowCol</span><span class="params">(grid: <span class="type">GridLayout</span>, t: <span class="type">FrameLayout</span>, x: <span class="type">Int</span>?, y: <span class="type">Int</span>?, xn: <span class="type">Int</span>?, yn: <span class="type">Int</span>?)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">val</span> par = GridLayout.LayoutParams()   <span class="comment">//每个子布局单独获取,并分配区域</span></div><div class="line"></div><div class="line">        par.rowSpec = GridLayout.spec(y <span class="keyword">as</span> <span class="built_in">Int</span>, yn <span class="keyword">as</span> <span class="built_in">Int</span>)</div><div class="line">        par.columnSpec = GridLayout.spec(x <span class="keyword">as</span> <span class="built_in">Int</span>, xn <span class="keyword">as</span> <span class="built_in">Int</span>)</div><div class="line">        par.height = height / mainY * yn</div><div class="line">        par.width = width / mainX * xn</div><div class="line"></div><div class="line">        <span class="comment">//判断子布局的上下左右是否为边界,是,就不留间隔.</span></div><div class="line">        <span class="keyword">if</span> (<span class="number">0</span> != y) &#123;</div><div class="line">            par.topMargin = <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (<span class="number">0</span> != x) &#123;</div><div class="line">            par.leftMargin = <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (mainX != (x + xn)) &#123;</div><div class="line">            par.rightMargin = <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (mainY != (y + yn)) &#123;</div><div class="line">            par.rightMargin = <span class="number">1</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        t.layoutParams = par</div><div class="line"></div><div class="line">        grid.addView(t, par)</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>到这里基本就是这个动态设置的思路，需要注意的是，每次添加布局，子布局的大小以及位置不能有冲突，不然子布局会重叠，这个需要添加之前就计算好。</p>
<p>我这边自己手动添加了 2  个集合用来 for循环添加子布局。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">listone = ArrayList()</div><div class="line">listone?.add(Data.Single.getInstance(<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>))</div><div class="line">listone?.add(Data.Single.getInstance(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>))</div><div class="line"></div><div class="line">listtwo = ArrayList()</div><div class="line">listtwo?.add(Data.Single.getInstance(<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>))</div><div class="line">listtwo?.add(Data.Single.getInstance(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>))</div><div class="line">listtwo?.add(Data.Single.getInstance(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> listone!!.indices) &#123;</div><div class="line">   <span class="keyword">val</span> <span class="keyword">data</span>: Data = listone!!.<span class="keyword">get</span>(i)</div><div class="line"></div><div class="line">   <span class="keyword">val</span> fragmentlayout: FrameLayout = FrameLayout(<span class="keyword">this</span>)</div><div class="line">   fragmentLayouts?.add(fragmentlayout)</div><div class="line">   fragmentlayout.id = View.generateViewId()</div><div class="line">   setSpanRowCol(grid_layout, fragmentlayout, <span class="keyword">data</span>.x, <span class="keyword">data</span>.y, <span class="keyword">data</span>.xn, <span class="keyword">data</span>.yn)</div><div class="line">                         addFragment(EasyFragment.Single.getInstance(i.toString()),  fragmentlayout.id)</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>基本到这里整个动态 GridLayout 的添加就算完成了，下面主要介绍下本编中用到的 Kotlin 语言的相关知识。</p>
<h5 id="2-Kotlin-简单语法介绍"><a href="#2-Kotlin-简单语法介绍" class="headerlink" title="2.Kotlin 简单语法介绍"></a>2.Kotlin 简单语法介绍</h5><ol>
<li><p>Kotlin 变量，常量</p>
<p>变量 var，常量 val 表示，这点比 Java 中简洁多了，跟 JavaScript 类似。</p>
</li>
<li><p>Kotlin 数据初始化</p>
<p>Kotlin 中的数据类型跟 java 中类似，基础数据类型都包含有。</p>
<p>而 Kotlin 对于数据或者对象的初始化可以直接通过 ：来代替数据类型，也可以直接用 = 直接表明类型，该类型会直接饮用 = 后面的数据类型。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> height : <span class="built_in">Int</span>? = <span class="literal">null</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> height = <span class="number">0</span>   <span class="comment">//屏幕高度</span></div></pre></td></tr></table></figure>
</li>
<li><p>Kotlin 空指针</p>
<blockquote>
<p>在Kotlin中空指针异常得到了很好的解决。</p>
<ul>
<li>在类型上的处理，即在类型后面加上?，即表示这个变量或参数以及返回值可以为null，否则不允许为变量参数赋值为null或者返回null</li>
<li>对于一个可能是null的变量或者参数，在调用对象方法或者属性之前，需要加上?，否则编译无法通过。</li>
</ul>
<p>如下面的代码就是Kotlin实现空指针安全的一个例子，而且相对Java实现而言，简直是一行代码搞定的。</p>
</blockquote>
<p>这里不单独对空指针问题进行介绍了，毕竟这个属于学习 Kotlin 中的一个复杂点，关于空指针安全原理，可以参考这篇文章<a href="http://droidyue.com/blog/2017/05/08/how-to-study-kotlin/" target="_blank" rel="external">研究学习 Kotlin 的一些方法</a></p>
</li>
<li><p>Kotlin 的类型转换</p>
<p>在实际项目中会经常遇到数据类型转换问题，在 Kotlin 中，会经常遇到比如 Int? 转化为 Int ，就可以直接用 as 直接转化</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">y <span class="keyword">as</span> <span class="built_in">Int</span></div></pre></td></tr></table></figure>
<p>这一串代码直接将 y 重新赋值成 Int 类型，相当于java中的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">y = Integer.valueOf(y)</div></pre></td></tr></table></figure>
<p>简洁明了。当然 Kotlin 也支持多种转化方式，比如toInt，toString等等。</p>
</li>
<li><p>Kotlin 方法类别</p>
<p>代码中直接用 fun 就能表面是一个方法，甚至都不需要 function。</p>
<p>而且直接设置该方法的返回类型，也只需要用 ：来表面，比如</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">parse</span><span class="params">(url: <span class="type">String</span>)</span></span>: String &#123;</div><div class="line">  retrun url</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那这里就必须返回一个 String 类型。</p>
</li>
<li><p>Kotlin 方法扩展</p>
<blockquote>
<p>很多时候，Framework提供给我们的API往往都时比较原子的，调用时需要我们进行组合处理，因为就会产生了一些Util类，一个简单的例子，我们想要更快捷的展示Toast信息，在Java中我们可以这样做。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;<span class="keyword">public</span> static void longToast(Context context, String message) &#123;</div><div class="line">&gt;    Toast.makeText(context, message,     Toast.LENGTH_LONG).show();</div><div class="line">&gt;&#125;</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>但是Kotlin的实现却让人惊奇，我们只需要重写扩展方法就可以了，比如这个longToast方法扩展到所有的Context对象中，如果不去追根溯源，可能无法区分是Framework提供的还是自行扩展的。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;<span class="function"><span class="keyword">fun</span> Context.<span class="title">longToast</span><span class="params">(message: <span class="type">String</span>)</span></span> &#123;</div><div class="line">&gt;    Toast.makeText(<span class="keyword">this</span>, message, Toast.LENGTH_LONG).show()</div><div class="line">&gt;&#125;</div><div class="line">&gt;applicationContext.longToast(<span class="string">"hello world"</span>)</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>注意：Kotlin的方法扩展并不是真正修改了对应的类文件，而是在编译器和IDE方面做得处理。使我们看起来像是扩展了方法。</p>
</blockquote>
<p>本次项目中就使用到了该方法，通常在 BaseActivity 中，扩展一些方法比如正常的添加 fragment ，可以直接类似重写一般的扩展:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Fragment 添加</span></div><div class="line">   <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> FragmentManager.<span class="title">inTransaction</span><span class="params">(func:    <span class="type">FragmentTransaction</span>.()</span></span> -&gt; FragmentTransaction) &#123;</div><div class="line">       beginTransaction().func().commit()</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">fun</span> AppCompatActivity.<span class="title">addFragment</span><span class="params">(fragment: <span class="type">Fragment</span>, frameId: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">       supportFragmentManager.inTransaction &#123; add(frameId, fragment) &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> AppCompatActivity.<span class="title">replaceFragment</span><span class="params">(fragment: <span class="type">Fragment</span>, frameId: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">supportFragmentManager.inTransaction &#123; replace(frameId, fragment) &#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>​       那我们在之后继承了 BaseActivity 的 Activity 中都可以直接调用 addFragment 和 replaceFragment 方法:</p>
   <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">addFragment(EasyFragment.Single.getInstance(i.toString()), fragmentlayout.id)</div></pre></td></tr></table></figure>
<ol>
<li><p>Kotlin 单例模式</p>
<p>我们经常要在一些 class 中使用到单例模式，一般好的 java 中都是这么调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> MyPicasso myPicasso;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (myPicasso == <span class="keyword">null</span>)</div><div class="line">		myPicasso = <span class="keyword">new</span> MyPicasso();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyPicasso <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (myPicasso == <span class="keyword">null</span>)</div><div class="line">		createInstance();</div><div class="line"></div><div class="line">	<span class="keyword">return</span> myPicasso;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过一个 synchronized 进行一个异步创建单例，但是这样代码很多了就，而且不方便。但是在 Kotlin 中可以直接一个 Object 解决问题。并且可以在这个 object中进行一些具体操作，很方便。我在一个 Fragment 实现单例，并且可以直接传入参数。相当简洁。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">object</span> Single &#123;</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">getInstance</span><span class="params">(str: <span class="type">String</span>)</span></span>: EasyFragment &#123;</div><div class="line">            <span class="keyword">val</span> instance: EasyFragment = EasyFragment()</div><div class="line">            instance.mStr = str</div><div class="line">            <span class="keyword">return</span> instance</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Kotlin 数据序列化</p>
<p>在 java 中一般都要继承 2 个接口 Serializable 或者 Parcelable ，虽然现在有了工具不需要手写 get 和 set，但是代码量在那边摆着呢，显得很麻烦。</p>
<p>而在 Kotlin 中，直接一个 data class 就直接搞定，Kotlin 中自动包含了setter 和 getter。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 数据Model</div><div class="line"> */</div><div class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Data</span></span>(<span class="keyword">val</span> x: <span class="built_in">Int</span>, <span class="keyword">val</span> y: <span class="built_in">Int</span>, <span class="keyword">val</span> xn: <span class="built_in">Int</span>, <span class="keyword">val</span> yn: <span class="built_in">Int</span>) &#123;&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>通过本次实际程序，基本可以对 Kotlin 的用法有个基本了解了，有不会的地方大可以直接 Google，国外对于该方面的资料还是比国内多很多。欢迎各位的学习讨论。</p>
<h5 id="源码地址"><a href="#源码地址" class="headerlink" title="源码地址"></a>源码地址</h5><p>废话不多说，直接上源码：<a href="https://github.com/timelove/GridDemo" target="_blank" rel="external">源码地址</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/09/14/Django学习一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/14/Django学习一/" itemprop="url">
                  Django学习一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-14T09:36:02+08:00">
                2017-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>前言：</strong> 最近 python 语言在编程界的受欢迎力度不减，长期稳居编程语言前 5 。而 python 在欧美国家，是拿来作为入门级编程语言。python 不仅可以用来编写传统 WEB 开发，GUI 应用开发，也可以用到现在主流的数据分析，以及人工智能方向，可谓是一个多功能型的语言。而本次学习，主要是以 Web 开发为主。</p>
<p><em>打好学习 pyhton 的基础，为以后的机器学习做准备。</em></p>
<h2 id="Python-之-Django"><a href="#Python-之-Django" class="headerlink" title="Python 之 Django"></a>Python 之 Django</h2><p>python web 的开发框架现在越来越多，并且也都趋于成熟。现在主流的 python web 开发框架包含有 Django, Flask , Pyramid , Tornado 等。具体前 3 种框架的区别可以看<a href="http://python.jobbole.com/81396/" target="_blank" rel="external">这里</a>。</p>
<p>本篇主要是以 Django 为学习。</p>
<ul>
<li><p>Django 框架是什么？</p>
<blockquote>
<p>Django is a high-level Python Web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of Web development, so you can focus on writing your app without needing to reinvent the wheel. It’s free and open source.(来自<a href="https://www.djangoproject.com/" target="_blank" rel="external"> Django 官网</a>)</p>
</blockquote>
</li>
<li><p>学习中用到的工具</p>
<p>本人是在 Windows 10 版本上进行的开发，在这里推荐同学们使用 MAC 或者 Linux 进行开发，因为在后 2 个平台上面已经自动集成 python 的开发环境。这里主要介绍如何在 Windows 上进行有一个比较舒适的 python 开发姿势。</p>
<ul>
<li><p>工具：<a href="https://code.visualstudio.com/" target="_blank" rel="external">Viual Studio Code</a>，优点我不累赘了，google 一下很多关于该工具的有点，使用起来也是美滋滋，相对于之前我使用过的 Sublime 3 ，个人推荐这款工具作为 python 开发（个人觉得 Sublime 的使用对于新手比较不那么友好）。</p>
</li>
<li><p>环境：python 安装，这里也是 Google 一下，很多教程，基本大同小异，这里本人用的是 python 3.5.4 64 bit 版本。（<a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014316090478912dab2a3a9e8f4ed49d28854b292f85bb000" target="_blank" rel="external">廖雪峰的 Python 安装教程</a>）    </p>
</li>
<li><p>git 环境安装，因为后续的 Django 一些环境部署，包括 python 中一些类库的按照都需要用到 windows 指令，当然 vs code 工具中也自带有终端，不想按照可以略过。(<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137396287703354d8c6c01c904c7d9ff056ae23da865a000" target="_blank" rel="external">廖雪峰的 Git 安装教程</a>)</p>
</li>
<li><p>vs code 扩展插件按照：vs code的还有一个点好处就 是安装插件相当方便，并且配置相对于其他开发工具来说比较简单。点击左侧的扩展图标，进入到扩展程序。如下图：</p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fjk80w7wpuj2095088jrx.jpg" alt="扩展界面"></p>
<p>进入之后直接在搜索栏输入要安装的程序名称，就可以直接安装，下面我记录下本人所用到的扩展程序。</p>
<ul>
<li>1 Auto Close Tag</li>
<li>2 Auto Rename Tag</li>
<li>3 Beautify </li>
<li>4 Bootstrap 3 Snippets</li>
<li>5 Class autocomplete for HTML</li>
<li>6 Dash</li>
<li>7 Debugger for Chrome</li>
<li>8 Debugger for Firefox</li>
<li>9 Django Template</li>
<li>10 ESLint</li>
<li>11 Git History</li>
<li>12 HTML CSS Support </li>
<li>13 HTML Snippets</li>
<li>14 JavaScript SnipperPack</li>
<li>15 JQuery Code Snippets</li>
<li>16 JS-CSS-HTML Formatter</li>
<li>17 Language Support for Java</li>
<li>18 Mithril Emmet</li>
<li>19 Path Intellisense </li>
<li>20 Python </li>
<li>21 Python for VSCode</li>
<li>22 React Native Tools</li>
<li>23 Ractjs code snippets</li>
<li>24 Typings auto installer</li>
<li>25 vscode-flake8</li>
<li>26 vscode-icons</li>
</ul>
<p>这里就是我 vscode 中所有的扩展程序，这里我就不一一描述每个扩展程序的作用了，其中很多是关于代码规范，以及代码提示高亮准备的，为开发提供了便捷。因为整个 DJango 开发中涉及的内容很多，包含了数据库，python , html-css-js , MVC 开发模式等各种内容。后续有需要的话，会另写一篇关于 vscode 的文章，再详细介绍这些扩展程序的作用。</p>
<p>注意：其中部分扩展程序是需要在 vscode 的设置用进行文件部署设置的。</p>
<p>点击 文件 -&gt; 首选项 -&gt; 设置，到用户设置界面，在右侧可以进行覆盖设置，这些设置可以覆盖到原有的设置部分， 其中 “typescript.tsdk” 这一项可以略过，这是我在 React Ntive设置中进行的配置，其他都配置上。基本到这里，你的 vscode 就已经配置的差不多了。如下图：</p>
<p>​</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fjk8r5zueij20sw0frgns.jpg" alt="用户设置"></p>
</li>
</ul>
</li>
</ul>
<p>​          </p>
<h3 id="Django-的简单创建以及使用"><a href="#Django-的简单创建以及使用" class="headerlink" title="Django 的简单创建以及使用"></a>Django 的简单创建以及使用</h3><blockquote>
<p>VS Code提供了两种范围的设置，分别是User及Workspace. 用户级别的设置可以理解为全局设置，其中的设置对任一vscode实例都生效。工作区级别的设置则仅针对当前项目生效，配置文件存放在项目的 .vscode 文件夹中。一般在项目开发中我们使用工作区级别的设置。以下步骤记录了如何建立Django项目的基本目录结构。</p>
</blockquote>
<ol>
<li><p>首先创建一个空的文件夹，作为一个工作空间使用，例如 ：D:\python\django_project，进入该文件夹，并且右击空白选择 git bash 进入到终端(没安装 Git 的同学可以用自带的终端自行切换到该目录)。</p>
</li>
<li><p>在该终端输入 virtualenv env 创建 env 文件夹</p>
</li>
<li><p>在该目录下在创建一个 requirenments.txt 文件，文件中添加以下内容，pylint为python的静态语法检测器，pylint-django 是适用于 django 项目的语法检查其插件，autopep8 是代码格式化工具</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">django&lt;<span class="number">1.10</span></div><div class="line">pylint</div><div class="line">pylint-django</div><div class="line">autopep8</div></pre></td></tr></table></figure>
</li>
<li><p>双击 \env\Scripts\activate.bat 激活虚拟环境</p>
</li>
<li><p>在 git bash 中执行 pip install -r requirenments.txt 安装相关模块</p>
</li>
<li><p>再执行 django-admin startproject mysitedemo ，在当前目录下创建一个 django 项目文件夹</p>
</li>
<li><p>进入 mysitedemo 目录，再执行 python manage.py startapp mysite 来新建一个 django app。</p>
</li>
<li><p>在 Vs Code 中选择打开文件夹方式打开该文件 django_project</p>
</li>
<li><p>在 Vs Code 中按下 Ctrl + Shift + P ，输入 Python ，然后选择 Python: Select Workspace Interpreter，在弹出框中选择 env 下的 python 。如图：</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fjkars69svj20lz06cglt.jpg" alt="选择图"></p>
</li>
<li><p>在 Vs Code 中按下 Ctrl + Shift + P，输入 workspace，选择Preferences: Open Workspace Settings，配置如下的 JSON文件。</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fjkaw61ncij20p80b9wfo.jpg" alt="配置"></p>
 <figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> <span class="attr">"python.pythonPath"</span>: <span class="string">"d:/python/django_project/env/scripts/python.exe"</span>,</div><div class="line"> <span class="attr">"python.linting.pylintPath"</span>: <span class="string">"pylint"</span>,</div><div class="line"> <span class="attr">"python.linting.pylintArgs"</span>: [</div><div class="line">     <span class="string">"--load-plugins"</span>, <span class="string">"pylint_django"</span></div><div class="line"> ],</div><div class="line"> <span class="attr">"python.formatting.autopep8Path"</span>: <span class="string">"autopep8"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>配置完成后，我们就可以继续项目开发了。</p>
</li>
</ol>
<h4 id="Django的简单使用"><a href="#Django的简单使用" class="headerlink" title="Django的简单使用"></a>Django的简单使用</h4><p>首先我们看下项目目录结构的具体情况</p>
<p><img src="https://ws1.sinaimg.cn/large/dcc3cfcdgy1fjkc212jk9j204x0dat8x.jpg" alt="项目结构"></p>
<h4 id="熟悉下目录结构："><a href="#熟悉下目录结构：" class="headerlink" title="熟悉下目录结构："></a>熟悉下目录结构：</h4><ul>
<li>最外层的 mysitedemo 也就是我们手动创建的文件夹，它在这里仅仅是项目的容器，它的命名对整个项目 都无关紧要，可以随便改。</li>
<li>mysitedemo/manage.py，这是一个命令工具，可以使你用多种方式对 Django 项目进行交互。包括之前我们用来的命令 startapp 来创建的 mysite.</li>
<li>mysitedemo/mysitedemo目录是项目中真正的 Python 包</li>
<li>mysitedemo/<strong>init</strong>.py，这是一个空文件，它的目的就是告诉 Python 这个目录应该被看做一个 Python 包。</li>
<li>mysitedemo/settings.py，该文件为 Django 项目的配置文件</li>
<li>mysietedemo/urls.py，该文件为 Django 的 URL 声明</li>
<li>mysitedemo/wsgi.py，用于你的项目的与WSGI兼容的Web服务器入口</li>
<li>mysitedemo/mysite，该文件夹为创建的新文件夹，用来做具体的项目</li>
</ul>
<h4 id="数据库的建立"><a href="#数据库的建立" class="headerlink" title="数据库的建立"></a>数据库的建立</h4><p>Django 默认使用 SQLite。当然 Django 对其他数据库也是支持的。通常使用数据库需要在 mysitedemo/setting.py 中进行配置，使用默认数据库比较简单明了，如果使用其他远程数据库或者已经创建好的本地数据库文件，比如 MySQL，就需要在配置文件中进行详细的配置，添加User,password,hoset等额外的配置。</p>
<p>这里我们优先选用默认的 SQLite，方便使用和学习。</p>
<p>打开 setting.py 文件，找到 DATABASES ，在 ‘default’ 条目中可以看到以下的配置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">'default': &#123;</div><div class="line">       'ENGINE': 'django.db.backends.sqlite3',</div><div class="line">       'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>当使用 SQLite，你不需要事先创建任何东西，数据库文件将会在需要的时候自动创建。</p>
<p>这里我们暂时需要一个数据库表，直接运行以下命令：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py migrate</div></pre></td></tr></table></figure>
<p>这时，项目目录中会直接出现一个数据库表 db.sqlite3</p>
<h3 id="本次学习总结"><a href="#本次学习总结" class="headerlink" title="本次学习总结"></a>本次学习总结</h3><p>本次主要介绍了 Django以及一些插件，和简单的DJango 项目部署，在下一节，将会采取实际项目来针对学习，根据具体需求来进行学习。</p>
<blockquote>
<p>写的不好的地方，请大家积极反应。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/07/04/牛客网算法之动态规则/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/04/牛客网算法之动态规则/" itemprop="url">
                  牛客网算法之动态规则
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T16:53:47+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近几天一直在牛客网上进行算法试题测试，在博客做下简单的记录。</p>
<p><a href="https://www.nowcoder.com/test/question/28c1dc06bc9b4afd957b01acdf046e69?pid=1725829&amp;tid=8984164" target="_blank" rel="external">原题地址</a></p>
<p><em>侵权删</em></p>
</blockquote>
<h3 id="题目：构造回文"><a href="#题目：构造回文" class="headerlink" title="题目：构造回文"></a>题目：构造回文</h3><p><strong>题目简介：</strong></p>
<p>给定一个字符串s，你可以从中删除一些字符，使得剩下的串是一个回文串。如何删除才能使得回文串最长呢？</p>
<p>输出需要删除的字符个数。</p>
<h5 id="输入描述"><a href="#输入描述" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入数据有多组，每组包含一个字符串s，且保证:1&lt;=s.length&lt;=1000.</div></pre></td></tr></table></figure>
<h5 id="输出描述"><a href="#输出描述" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">对于每组数据，输出一个整数，代表最少需要删除的字符个数。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">while</span> (sc.hasNext()) &#123;</div><div class="line">            String s1 = sc.next();</div><div class="line">            String s2 = <span class="keyword">new</span> StringBuilder(s1).reverse().toString();</div><div class="line">            <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[s1.length() + <span class="number">1</span>][s2.length() + <span class="number">1</span>];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; dp.length; i++) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; dp[<span class="number">0</span>].length; j++) &#123;</div><div class="line">                    dp[i][j] = s1.charAt(i - <span class="number">1</span>) == s2.charAt(j - <span class="number">1</span>) ? dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span> : Math</div><div class="line">                            .max(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>]);</div><div class="line"></div><div class="line">                    <span class="comment">//System.out.println(i + ":" + dp[i][j]);</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            System.out.println(s1.length() - dp[s1.length()][s2.length()]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明：</em></p>
<p><code>具体采用动态规则进行计算,原题目网中有大神进行了阐述，如下：</code></p>
<blockquote>
<p>提到回文串，自然要利用回文串的特点，想到将源字符串逆转后，“回文串”（不一定连续）相当于顺序没变求原字符串和其反串的<strong>最大公共子序列（不是子串，因为可以不连续）的长度（使用动态规划很容易求得）</strong>，然后用原字符串的长度减去这个最大公共子串的长度就得到了最小编辑长度。(侵权删)</p>
<blockquote>
<p>动态规则还有很多类似的算法，需要再接再厉！进行深一层次的学习。</p>
</blockquote>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/07/04/牛客网算法一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/04/牛客网算法一/" itemprop="url">
                  牛客网算法一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T16:45:12+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近几天一直在牛客网上进行算法试题测试，在博客做下简单的记录。</p>
<p><a href="https://www.nowcoder.com/test/question/bfb60fce32974c45a806e567e17183ba?pid=5507925&amp;tid=8981954" target="_blank" rel="external">原题地址</a></p>
<p><em>侵权删</em></p>
</blockquote>
<h3 id="题一：黑白卡片题"><a href="#题一：黑白卡片题" class="headerlink" title="题一：黑白卡片题"></a>题一：黑白卡片题</h3><p><strong>题目简介：</strong></p>
<p>牛牛有n张卡片排成一个序列.每张卡片一面是黑色的,另一面是白色的。初始状态的时候有些卡片是黑色朝上,有些卡片是白色朝上。牛牛现在想要把一些卡片翻过来,得到一种交替排列的形式,即每对相邻卡片的颜色都是不一样的。牛牛想知道最少需要翻转多少张卡片可以变成交替排列的形式。 </p>
<h5 id="输入描述"><a href="#输入描述" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串S,字符串长度length(3 ≤ length ≤ 50),其中只包含&apos;W&apos;和&apos;B&apos;两种字符串,分别表示白色和黑色。整个字符串表示卡片序列的初始状态。</div></pre></td></tr></table></figure>
<h5 id="输出描述"><a href="#输出描述" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最多需要翻转的次数</div></pre></td></tr></table></figure>
<p><strong>代码:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wb</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">while</span> (input.hasNext()) &#123;</div><div class="line">            String line = input.next();</div><div class="line">            <span class="keyword">int</span> b = <span class="number">0</span>, w = <span class="number">0</span>;<span class="comment">//w为WBWBWB序列需要翻次数，b为BWBWBWB序列需要翻次数</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = line.length(); i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">char</span> c = line.charAt(i);</div><div class="line">                <span class="comment">//判断位置</span></div><div class="line">                <span class="comment">//奇数位置</span></div><div class="line">                <span class="keyword">if</span> ((i &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">if</span> (c == <span class="string">'W'</span>) b++;</div><div class="line">                    <span class="keyword">else</span> w++;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">if</span> (c == <span class="string">'B'</span>) b++;</div><div class="line">                    <span class="keyword">else</span> w++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            System.out.println(Math.min(b, w));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>代码中的 i&amp;1 用来判断 i 奇偶，基本就是遍历所有的元素。因为整个排序片段只有 2 种情况，所有只需要获取 2 种情况下所得结果再进行比较得到最小值，就是最终结果。</code></p>
<h3 id="题目二：黑化的牛牛"><a href="#题目二：黑化的牛牛" class="headerlink" title="题目二：黑化的牛牛"></a>题目二：黑化的牛牛</h3><p><strong>题目简介：</strong></p>
<p>牛牛变得黑化了,想要摧毁掉地球。但他忘记了开启地球毁灭器的密码。牛牛手里有一个字符串S,牛牛还记得从S中去掉一个字符就恰好是正确的密码,请你帮牛牛求出他最多需要尝试多少次密码。</p>
<p>如样例所示S = “ABA”,3个可能的密码是”BA”, “AA”, “AB”.</p>
<p>当S = “A”, 牛牛唯一可以尝试的密码是一个空的密码,所以输出1. </p>
<h5 id="输入描述-1"><a href="#输入描述-1" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串S,字符串长度length(1 ≤ length ≤ 50),其中都是从&apos;A&apos;到&apos;Z&apos;的大写字母。</div></pre></td></tr></table></figure>
<h5 id="输出描述-1"><a href="#输出描述-1" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最多需要尝试的密码次数。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashSet;</div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Niuniuaaba</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">while</span> (input.hasNext()) &#123;</div><div class="line">            <span class="comment">//方法一：</span></div><div class="line"><span class="comment">//            String s = input.next();</span></div><div class="line"><span class="comment">//            if (s.length() == 0) &#123;</span></div><div class="line"><span class="comment">//                return;</span></div><div class="line"><span class="comment">//            &#125; else if (s.length() == 1) &#123;</span></div><div class="line"><span class="comment">//                System.out.print(s.length() + "");</span></div><div class="line"><span class="comment">//            &#125; else &#123;</span></div><div class="line"><span class="comment">//                char[] chas = s.toCharArray();</span></div><div class="line"><span class="comment">//                int re = 0;</span></div><div class="line"><span class="comment">//                for (int i = 1; i &lt; chas.length; i++) &#123;</span></div><div class="line"><span class="comment">//                    if (chas[i - 1] == chas[i]) &#123;</span></div><div class="line"><span class="comment">//                        re++;</span></div><div class="line"><span class="comment">//                    &#125;</span></div><div class="line"><span class="comment">//                &#125;</span></div><div class="line"><span class="comment">//                System.out.print(chas.length - re + "");</span></div><div class="line"><span class="comment">//            &#125;</span></div><div class="line"></div><div class="line">            <span class="comment">//方法二</span></div><div class="line">            String s2 = input.next();</div><div class="line">            <span class="keyword">if</span> (s2.length() == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s2.length() == <span class="number">1</span>) &#123;</div><div class="line">                System.out.print(s2.length() + <span class="string">""</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                StringBuffer s3 = <span class="keyword">new</span> StringBuffer(s2);</div><div class="line">                HashSet&lt;String&gt; hashSet = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s2.length(); i++) &#123;</div><div class="line">                    s3.deleteCharAt(i);</div><div class="line">                    <span class="keyword">boolean</span> add = hashSet.add(s3.toString());</div><div class="line">                    s3.insert(i, s2.charAt(i));</div><div class="line">                &#125;</div><div class="line">                System.out.print(hashSet.size() + <span class="string">""</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>本代码未做字符串‘A-Z’的判断;</code></p>
<p><code>方法一：这里根据只要遇到 2 个相同元素,就只有可能会出现一个秘密组, re(代码重复秘密组)就 +1 ,而如果没有重复组，最多尝试的秘密组其实就是依次去掉字符串中的每个个元素所得,即 chas.lenth ,所以最终解为 chas.length - re.</code></p>
<p><code>方法二：这里根据了 java Hashset 的定义去运算. HashSet 中不能添加同一个元素，所以,遍历所以字符串,依次去掉一个字符串组成新字符串加入 hashSet 中，最终 hashSet 的长度就为答案.</code></p>
<h3 id="题目三：膨胀的牛牛"><a href="#题目三：膨胀的牛牛" class="headerlink" title="题目三：膨胀的牛牛"></a>题目三：膨胀的牛牛</h3><p><strong>题目简介：</strong></p>
<p>牛牛以草料为食。牛牛有一天依次遇到n堆被施展了魔法的草料,牛牛只要遇到一堆跟他当前相同大小的草料,它就会把草料吃完,而使自己的大小膨胀一倍。一开始牛牛的大小的是A,然后给出牛牛依次遇到的n堆草料的大小。请计算牛牛最后的大小。 </p>
<h5 id="输入描述-2"><a href="#输入描述-2" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行包含两个整数n和A(1 ≤ n ≤ 200, 1 ≤ A ≤ 1,000,000,000)</div><div class="line">第二行包括n个整数,表示牛牛依次遇到的草料堆大小a_i(1 ≤ a_i ≤ 1,000,000,000)</div></pre></td></tr></table></figure>
<h5 id="输出描述-2"><a href="#输出描述-2" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最后的大小。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">int</span> num = input.nextInt();<span class="comment">//所有整数</span></div><div class="line">        <span class="keyword">int</span> a = input.nextInt();<span class="comment">//牛牛初始大小</span></div><div class="line">        <span class="keyword">int</span>[] a_i=<span class="keyword">new</span> <span class="keyword">int</span>[num];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num; i++)&#123;</div><div class="line">            a_i[i] = input.nextInt();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span> ;j&lt;num;j++)&#123;</div><div class="line">            <span class="keyword">if</span>(a==a_i[j])&#123;</div><div class="line">                a*=<span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        System.out.print(a);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="题目四：序列交换"><a href="#题目四：序列交换" class="headerlink" title="题目四：序列交换"></a>题目四：序列交换</h3><p><strong>题目简介：</strong></p>
<p>牛牛有一个长度为n的整数序列s,羊羊要在牛牛的序列中选择不同的两个位置,然后交换这两个位置上的元素。现在需要求出羊羊交换后可以得到的不同的序列个数。(注意被交换的两元素值可能相同)。</p>
<p>如序列{1, 47},输出1.羊羊必须交换仅有的两个元素,得到序列{47, 1}。羊羊必须交换,不能保留原有的序列。</p>
<p>{1, 2, 1},输出3.羊羊通过交换可以得到{2, 1, 1},{1, 1, 2},{1, 2, 1}这三个序列。 </p>
<h5 id="输入描述-3"><a href="#输入描述-3" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行为一个整数n(2 ≤ n ≤ 50),即序列的长度。</div><div class="line">第二行n个整数,表示序列的每个元素a_i(1 ≤ a_i ≤ 50),以空格分割。</div></pre></td></tr></table></figure>
<h5 id="输出描述-3"><a href="#输出描述-3" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示羊羊可以得到的不同的序列个数</div></pre></td></tr></table></figure>
<p><strong>代码说明：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;<span class="comment">//输入总数</span></div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i, j;</div><div class="line">        <span class="keyword">boolean</span> hasSame = <span class="keyword">false</span>;<span class="comment">//相同判断</span></div><div class="line"></div><div class="line">        num = sc.nextInt();</div><div class="line">        <span class="keyword">int</span>[] test = <span class="keyword">new</span> <span class="keyword">int</span>[num];</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num; i++) &#123;</div><div class="line">            test[i] = sc.nextInt();</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (num == <span class="number">2</span>) &#123;</div><div class="line">            System.out.print(<span class="number">1</span> + <span class="string">""</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; num; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (test[i] != test[j]) &#123;</div><div class="line">                    sum++;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    hasSame = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (hasSame) &#123;</div><div class="line">            System.out.print(sum + <span class="number">1</span> + <span class="string">""</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            System.out.print(sum + <span class="string">""</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>根据交换条件，只要交换的 2 个数字不一样，交换出来的数组肯定为新的一列数组,因此sum在这种情况下每次 +1,而当有 2 个数字一样的时候，在最后结果需要再 +1,因为相同的数字在同等的情况下只允许出现同一个情况,所以不管有多少组重复数字，都只需要最终 +1.当然,这里也可以运用 HashSet 的方式来解决,跟问题二中描述类似.</code></p>
<h3 id="问题五：丑陋的字符串"><a href="#问题五：丑陋的字符串" class="headerlink" title="问题五：丑陋的字符串"></a>问题五：丑陋的字符串</h3><p><strong>问题简介：</strong></p>
<p>牛牛喜欢字符串,但是他讨厌丑陋的字符串。对于牛牛来说,一个字符串的丑陋值是字符串中相同连续字符对的个数。比如字符串“ABABAABBB”的丑陋值是3,因为有一对”AA”和两对重叠的”BB”。现在给出一个字符串,字符串中包含字符’A’、’B’和’?’。牛牛现在可以把字符串中的问号改为’A’或者’B’。牛牛现在想让字符串的丑陋值最小,希望你能帮帮他。 </p>
<h5 id="输入描述-4"><a href="#输入描述-4" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串s,字符串长度length(1 ≤ length ≤ 50),字符串只包含&apos;A&apos;,&apos;B&apos;,&apos;?&apos;三种字符。</div></pre></td></tr></table></figure>
<h5 id="输出描述-4"><a href="#输出描述-4" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示最小的丑陋值</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">char</span>[] chars;</div><div class="line">        <span class="keyword">while</span> (sc.hasNext()) &#123;</div><div class="line">            String s = sc.next();</div><div class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (s.length() == <span class="number">1</span>) &#123;</div><div class="line">                System.out.print(<span class="number">0</span> + <span class="string">""</span>);</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//去除最前面的所有？</span></div><div class="line">                <span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (j != s.length() &amp;&amp; s.charAt(j) == <span class="string">'?'</span>) &#123;</div><div class="line">                    j++;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (j == s.length()) &#123;</div><div class="line">                    System.out.print(<span class="number">0</span> + <span class="string">""</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    s = s.substring(j, s.length());</div><div class="line"></div><div class="line">                    chars = s.toCharArray();</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; chars.length; i++) &#123;</div><div class="line">                        <span class="keyword">if</span> (<span class="string">'?'</span> == chars[i]) &#123;</div><div class="line">                            <span class="keyword">if</span> (chars[i - <span class="number">1</span>] == <span class="string">'A'</span>) &#123;</div><div class="line">                                chars[i] = <span class="string">'B'</span>;</div><div class="line">                            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                                chars[i] = <span class="string">'A'</span>;</div><div class="line">                            &#125;</div><div class="line">                        &#125; <span class="keyword">else</span> &#123;</div><div class="line">                            <span class="keyword">if</span> (chars[i - <span class="number">1</span>] == chars[i]) &#123;</div><div class="line">                                count++;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    System.out.print(count + <span class="string">""</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明：</em></p>
<p><code>因为只需要判断连续 2 位字符串是否相同，就可以判断到底有多少组丑陋值,按照顺时针方向,首先去除在开头所有的 ?,在依次判断接下来的字符串中是否包有 ?,有就把 ? 改成跟前一个字符不同的字符,再循环判断,最终可以得到所以的丑陋值 count.</code></p>
<h3 id="题目六：庆祝-61"><a href="#题目六：庆祝-61" class="headerlink" title="题目六：庆祝 61"></a>题目六：庆祝 61</h3><p><strong>题目简介：</strong></p>
<p>牛家庄幼儿园为庆祝61儿童节举办庆祝活动,庆祝活动中有一个节目是小朋友们围成一个圆圈跳舞。牛老师挑选出n个小朋友参与跳舞节目,已知每个小朋友的身高h_i。为了让舞蹈看起来和谐,牛老师需要让跳舞的圆圈队形中相邻小朋友的身高差的最大值最小,牛老师犯了难,希望你能帮帮他。</p>
<p>如样例所示:</p>
<p>当圆圈队伍按照100,98,103,105顺时针排列的时候最大身高差为5,其他排列不会得到更优的解 </p>
<h5 id="输入描述-5"><a href="#输入描述-5" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行为一个正整数n(3 ≤ n ≤ 20)</div><div class="line">第二行为n个整数h_i(80 ≤ h_i ≤ 140),表示每个小朋友的身高。</div></pre></td></tr></table></figure>
<h5 id="输出描述-5"><a href="#输出描述-5" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示满足条件下的相邻小朋友身高差的最大值。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> n = sc.nextInt();</div><div class="line">        <span class="keyword">int</span>[] m = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            m[i] = sc.nextInt();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Arrays.sort(m);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> max = Math.max(m[<span class="number">1</span>] - m[<span class="number">0</span>], m[n - <span class="number">1</span>] - m[n - <span class="number">2</span>]);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n - <span class="number">2</span>; j++) &#123;</div><div class="line">            max = Math.max(m[j + <span class="number">2</span>] - m[j], max);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.print(max);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明：</em></p>
<blockquote>
<p>首先该想到序号间隔越小差值也越小. 所以应该按顺序左右插入,这样形成一种金子塔型, 这样序号差值最大就只有2了,如有 1,2,3,4,5,6.7.应该排成7,5,3,1,2,4,6或1,3,5,7,6,4,2.(不是自己的思路，看到一个大神的思路,侵权删)</p>
</blockquote>
<p><code>先排序，把所以的数字根据升降排序列好,根据金字塔型,最顶端数字为最大数或者最小数，左侧一列为与顶端数字位置相差为2的数字(m[j+2])，右侧则为相差1的数字(m[j+1]),而算出最大身高差,可以看出,只需要计算金字塔左侧和右侧每个相邻数字之差中的最大值就可以获得.</code></p>
<blockquote>
<p>说明：上面所有代码段本人都亲自敲过，并且在牛客网都可以通过。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/07/04/牛客网试题一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/04/牛客网试题一/" itemprop="url">
                  牛客网试题--系列一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T15:11:00+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近几天一直在牛客网上进行算法试题测试，在博客做下简单的记录。</p>
<p><a href="https://www.nowcoder.com/test/question/bfb60fce32974c45a806e567e17183ba?pid=5507925&amp;tid=8981954" target="_blank" rel="external">原题地址</a></p>
<p><em>侵权删</em></p>
</blockquote>
<h3 id="题一：黑白卡片题"><a href="#题一：黑白卡片题" class="headerlink" title="题一：黑白卡片题"></a>题一：黑白卡片题</h3><p><strong>题目简介：</strong></p>
<p>牛牛有n张卡片排成一个序列.每张卡片一面是黑色的,另一面是白色的。初始状态的时候有些卡片是黑色朝上,有些卡片是白色朝上。牛牛现在想要把一些卡片翻过来,得到一种交替排列的形式,即每对相邻卡片的颜色都是不一样的。牛牛想知道最少需要翻转多少张卡片可以变成交替排列的形式。 </p>
<h5 id="输入描述"><a href="#输入描述" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串S,字符串长度length(3 ≤ length ≤ 50),其中只包含&apos;W&apos;和&apos;B&apos;两种字符串,分别表示白色和黑色。整个字符串表示卡片序列的初始状态。</div></pre></td></tr></table></figure>
<h5 id="输出描述"><a href="#输出描述" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最多需要翻转的次数</div></pre></td></tr></table></figure>
<p><strong>代码:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wb</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">while</span> (input.hasNext()) &#123;</div><div class="line">            String line = input.next();</div><div class="line">            <span class="keyword">int</span> b = <span class="number">0</span>, w = <span class="number">0</span>;<span class="comment">//w为WBWBWB序列需要翻次数，b为BWBWBWB序列需要翻次数</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = line.length(); i &lt; len; i++) &#123;</div><div class="line">                <span class="keyword">char</span> c = line.charAt(i);</div><div class="line">                <span class="comment">//判断位置</span></div><div class="line">                <span class="comment">//奇数位置</span></div><div class="line">                <span class="keyword">if</span> ((i &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">if</span> (c == <span class="string">'W'</span>) b++;</div><div class="line">                    <span class="keyword">else</span> w++;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">if</span> (c == <span class="string">'B'</span>) b++;</div><div class="line">                    <span class="keyword">else</span> w++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            System.out.println(Math.min(b, w));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>代码中的 i&amp;1 用来判断 i 奇偶，基本就是遍历所有的元素。因为整个排序片段只有 2 种情况，所有只需要获取 2 种情况下所得结果再进行比较得到最小值，就是最终结果。</code></p>
<h3 id="题目二：黑化的牛牛"><a href="#题目二：黑化的牛牛" class="headerlink" title="题目二：黑化的牛牛"></a>题目二：黑化的牛牛</h3><p><strong>题目简介：</strong></p>
<p>牛牛变得黑化了,想要摧毁掉地球。但他忘记了开启地球毁灭器的密码。牛牛手里有一个字符串S,牛牛还记得从S中去掉一个字符就恰好是正确的密码,请你帮牛牛求出他最多需要尝试多少次密码。</p>
<p>如样例所示S = “ABA”,3个可能的密码是”BA”, “AA”, “AB”.</p>
<p>当S = “A”, 牛牛唯一可以尝试的密码是一个空的密码,所以输出1. </p>
<h5 id="输入描述-1"><a href="#输入描述-1" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串S,字符串长度length(1 ≤ length ≤ 50),其中都是从&apos;A&apos;到&apos;Z&apos;的大写字母。</div></pre></td></tr></table></figure>
<h5 id="输出描述-1"><a href="#输出描述-1" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最多需要尝试的密码次数。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashSet;</div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Niuniuaaba</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">while</span> (input.hasNext()) &#123;</div><div class="line">            <span class="comment">//方法一：</span></div><div class="line"><span class="comment">//            String s = input.next();</span></div><div class="line"><span class="comment">//            if (s.length() == 0) &#123;</span></div><div class="line"><span class="comment">//                return;</span></div><div class="line"><span class="comment">//            &#125; else if (s.length() == 1) &#123;</span></div><div class="line"><span class="comment">//                System.out.print(s.length() + "");</span></div><div class="line"><span class="comment">//            &#125; else &#123;</span></div><div class="line"><span class="comment">//                char[] chas = s.toCharArray();</span></div><div class="line"><span class="comment">//                int re = 0;</span></div><div class="line"><span class="comment">//                for (int i = 1; i &lt; chas.length; i++) &#123;</span></div><div class="line"><span class="comment">//                    if (chas[i - 1] == chas[i]) &#123;</span></div><div class="line"><span class="comment">//                        re++;</span></div><div class="line"><span class="comment">//                    &#125;</span></div><div class="line"><span class="comment">//                &#125;</span></div><div class="line"><span class="comment">//                System.out.print(chas.length - re + "");</span></div><div class="line"><span class="comment">//            &#125;</span></div><div class="line"></div><div class="line">            <span class="comment">//方法二</span></div><div class="line">            String s2 = input.next();</div><div class="line">            <span class="keyword">if</span> (s2.length() == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s2.length() == <span class="number">1</span>) &#123;</div><div class="line">                System.out.print(s2.length() + <span class="string">""</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                StringBuffer s3 = <span class="keyword">new</span> StringBuffer(s2);</div><div class="line">                HashSet&lt;String&gt; hashSet = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s2.length(); i++) &#123;</div><div class="line">                    s3.deleteCharAt(i);</div><div class="line">                    <span class="keyword">boolean</span> add = hashSet.add(s3.toString());</div><div class="line">                    s3.insert(i, s2.charAt(i));</div><div class="line">                &#125;</div><div class="line">                System.out.print(hashSet.size() + <span class="string">""</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>本代码未做字符串‘A-Z’的判断;</code></p>
<p><code>方法一：这里根据只要遇到 2 个相同元素,就只有可能会出现一个秘密组, re(代码重复秘密组)就 +1 ,而如果没有重复组，最多尝试的秘密组其实就是依次去掉字符串中的每个个元素所得,即 chas.lenth ,所以最终解为 chas.length - re.</code></p>
<p><code>方法二：这里根据了 java Hashset 的定义去运算. HashSet 中不能添加同一个元素，所以,遍历所以字符串,依次去掉一个字符串组成新字符串加入 hashSet 中，最终 hashSet 的长度就为答案.</code></p>
<h3 id="题目三：膨胀的牛牛"><a href="#题目三：膨胀的牛牛" class="headerlink" title="题目三：膨胀的牛牛"></a>题目三：膨胀的牛牛</h3><p><strong>题目简介：</strong></p>
<p>牛牛以草料为食。牛牛有一天依次遇到n堆被施展了魔法的草料,牛牛只要遇到一堆跟他当前相同大小的草料,它就会把草料吃完,而使自己的大小膨胀一倍。一开始牛牛的大小的是A,然后给出牛牛依次遇到的n堆草料的大小。请计算牛牛最后的大小。 </p>
<h5 id="输入描述-2"><a href="#输入描述-2" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行包含两个整数n和A(1 ≤ n ≤ 200, 1 ≤ A ≤ 1,000,000,000)</div><div class="line">第二行包括n个整数,表示牛牛依次遇到的草料堆大小a_i(1 ≤ a_i ≤ 1,000,000,000)</div></pre></td></tr></table></figure>
<h5 id="输出描述-2"><a href="#输出描述-2" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示牛牛最后的大小。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">int</span> num = input.nextInt();<span class="comment">//所有整数</span></div><div class="line">        <span class="keyword">int</span> a = input.nextInt();<span class="comment">//牛牛初始大小</span></div><div class="line">        <span class="keyword">int</span>[] a_i=<span class="keyword">new</span> <span class="keyword">int</span>[num];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num; i++)&#123;</div><div class="line">            a_i[i] = input.nextInt();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span> ;j&lt;num;j++)&#123;</div><div class="line">            <span class="keyword">if</span>(a==a_i[j])&#123;</div><div class="line">                a*=<span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        System.out.print(a);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="题目四：序列交换"><a href="#题目四：序列交换" class="headerlink" title="题目四：序列交换"></a>题目四：序列交换</h3><p><strong>题目简介：</strong></p>
<p>牛牛有一个长度为n的整数序列s,羊羊要在牛牛的序列中选择不同的两个位置,然后交换这两个位置上的元素。现在需要求出羊羊交换后可以得到的不同的序列个数。(注意被交换的两元素值可能相同)。</p>
<p>如序列{1, 47},输出1.羊羊必须交换仅有的两个元素,得到序列{47, 1}。羊羊必须交换,不能保留原有的序列。</p>
<p>{1, 2, 1},输出3.羊羊通过交换可以得到{2, 1, 1},{1, 1, 2},{1, 2, 1}这三个序列。 </p>
<h5 id="输入描述-3"><a href="#输入描述-3" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行为一个整数n(2 ≤ n ≤ 50),即序列的长度。</div><div class="line">第二行n个整数,表示序列的每个元素a_i(1 ≤ a_i ≤ 50),以空格分割。</div></pre></td></tr></table></figure>
<h5 id="输出描述-3"><a href="#输出描述-3" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示羊羊可以得到的不同的序列个数</div></pre></td></tr></table></figure>
<p><strong>代码说明：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;<span class="comment">//输入总数</span></div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i, j;</div><div class="line">        <span class="keyword">boolean</span> hasSame = <span class="keyword">false</span>;<span class="comment">//相同判断</span></div><div class="line"></div><div class="line">        num = sc.nextInt();</div><div class="line">        <span class="keyword">int</span>[] test = <span class="keyword">new</span> <span class="keyword">int</span>[num];</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num; i++) &#123;</div><div class="line">            test[i] = sc.nextInt();</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (num == <span class="number">2</span>) &#123;</div><div class="line">            System.out.print(<span class="number">1</span> + <span class="string">""</span>);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; num; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (test[i] != test[j]) &#123;</div><div class="line">                    sum++;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    hasSame = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (hasSame) &#123;</div><div class="line">            System.out.print(sum + <span class="number">1</span> + <span class="string">""</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            System.out.print(sum + <span class="string">""</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明:</em></p>
<p><code>根据交换条件，只要交换的 2 个数字不一样，交换出来的数组肯定为新的一列数组,因此sum在这种情况下每次 +1,而当有 2 个数字一样的时候，在最后结果需要再 +1,因为相同的数字在同等的情况下只允许出现同一个情况,所以不管有多少组重复数字，都只需要最终 +1.当然,这里也可以运用 HashSet 的方式来解决,跟问题二中描述类似.</code></p>
<h3 id="问题五：丑陋的字符串"><a href="#问题五：丑陋的字符串" class="headerlink" title="问题五：丑陋的字符串"></a>问题五：丑陋的字符串</h3><p><strong>问题简介：</strong></p>
<p>牛牛喜欢字符串,但是他讨厌丑陋的字符串。对于牛牛来说,一个字符串的丑陋值是字符串中相同连续字符对的个数。比如字符串“ABABAABBB”的丑陋值是3,因为有一对”AA”和两对重叠的”BB”。现在给出一个字符串,字符串中包含字符’A’、’B’和’?’。牛牛现在可以把字符串中的问号改为’A’或者’B’。牛牛现在想让字符串的丑陋值最小,希望你能帮帮他。 </p>
<h5 id="输入描述-4"><a href="#输入描述-4" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输入包括一个字符串s,字符串长度length(1 ≤ length ≤ 50),字符串只包含&apos;A&apos;,&apos;B&apos;,&apos;?&apos;三种字符。</div></pre></td></tr></table></figure>
<h5 id="输出描述-4"><a href="#输出描述-4" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示最小的丑陋值</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">        <span class="keyword">char</span>[] chars;</div><div class="line">        <span class="keyword">while</span> (sc.hasNext()) &#123;</div><div class="line">            String s = sc.next();</div><div class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (s.length() == <span class="number">1</span>) &#123;</div><div class="line">                System.out.print(<span class="number">0</span> + <span class="string">""</span>);</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//去除最前面的所有？</span></div><div class="line">                <span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (j != s.length() &amp;&amp; s.charAt(j) == <span class="string">'?'</span>) &#123;</div><div class="line">                    j++;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (j == s.length()) &#123;</div><div class="line">                    System.out.print(<span class="number">0</span> + <span class="string">""</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    s = s.substring(j, s.length());</div><div class="line"></div><div class="line">                    chars = s.toCharArray();</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; chars.length; i++) &#123;</div><div class="line">                        <span class="keyword">if</span> (<span class="string">'?'</span> == chars[i]) &#123;</div><div class="line">                            <span class="keyword">if</span> (chars[i - <span class="number">1</span>] == <span class="string">'A'</span>) &#123;</div><div class="line">                                chars[i] = <span class="string">'B'</span>;</div><div class="line">                            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                                chars[i] = <span class="string">'A'</span>;</div><div class="line">                            &#125;</div><div class="line">                        &#125; <span class="keyword">else</span> &#123;</div><div class="line">                            <span class="keyword">if</span> (chars[i - <span class="number">1</span>] == chars[i]) &#123;</div><div class="line">                                count++;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    System.out.print(count + <span class="string">""</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明：</em></p>
<p><code>因为只需要判断连续 2 位字符串是否相同，就可以判断到底有多少组丑陋值,按照顺时针方向,首先去除在开头所有的 ?,在依次判断接下来的字符串中是否包有 ?,有就把 ? 改成跟前一个字符不同的字符,再循环判断,最终可以得到所以的丑陋值 count.</code></p>
<h3 id="题目六：庆祝-61"><a href="#题目六：庆祝-61" class="headerlink" title="题目六：庆祝 61"></a>题目六：庆祝 61</h3><p><strong>题目简介：</strong></p>
<p>牛家庄幼儿园为庆祝61儿童节举办庆祝活动,庆祝活动中有一个节目是小朋友们围成一个圆圈跳舞。牛老师挑选出n个小朋友参与跳舞节目,已知每个小朋友的身高h_i。为了让舞蹈看起来和谐,牛老师需要让跳舞的圆圈队形中相邻小朋友的身高差的最大值最小,牛老师犯了难,希望你能帮帮他。</p>
<p>如样例所示:</p>
<p>当圆圈队伍按照100,98,103,105顺时针排列的时候最大身高差为5,其他排列不会得到更优的解 </p>
<h5 id="输入描述-5"><a href="#输入描述-5" class="headerlink" title="输入描述:"></a><strong>输入描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">输入包括两行,第一行为一个正整数n(3 ≤ n ≤ 20)</div><div class="line">第二行为n个整数h_i(80 ≤ h_i ≤ 140),表示每个小朋友的身高。</div></pre></td></tr></table></figure>
<h5 id="输出描述-5"><a href="#输出描述-5" class="headerlink" title="输出描述:"></a><strong>输出描述:</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">输出一个整数,表示满足条件下的相邻小朋友身高差的最大值。</div></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> n = sc.nextInt();</div><div class="line">        <span class="keyword">int</span>[] m = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            m[i] = sc.nextInt();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Arrays.sort(m);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> max = Math.max(m[<span class="number">1</span>] - m[<span class="number">0</span>], m[n - <span class="number">1</span>] - m[n - <span class="number">2</span>]);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n - <span class="number">2</span>; j++) &#123;</div><div class="line">            max = Math.max(m[j + <span class="number">2</span>] - m[j], max);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.print(max);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>代码说明：</em></p>
<blockquote>
<p>首先该想到序号间隔越小差值也越小. 所以应该按顺序左右插入,这样形成一种金子塔型, 这样序号差值最大就只有2了,如有 1,2,3,4,5,6.7.应该排成7,5,3,1,2,4,6或1,3,5,7,6,4,2.(不是自己的思路，看到一个大神的思路,侵权删)</p>
</blockquote>
<p><code>先排序，把所以的数字根据升降排序列好,根据金字塔型,最顶端数字为最大数或者最小数，左侧一列为与顶端数字位置相差为2的数字(m[j+2])，右侧则为相差1的数字(m[j+1]),而算出最大身高差,可以看出,只需要计算金字塔左侧和右侧每个相邻数字之差中的最大值就可以获得.</code></p>
<blockquote>
<p>说明：上面所有代码段本人都亲自敲过，并且在牛客网都可以通过。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/05/03/python杨辉三角/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/python杨辉三角/" itemprop="url">
                  python杨辉三角
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T20:41:44+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近一直在自学 Python ，学习过一段时间后，为了方便以后自己的记忆。写一些学习过程中的东西，用来来记录之前的学习过程，本篇通过杨辉三角来记录下之前的学习经历。</p>
<p>平时主要在廖雪峰老师的教程网站上进行学习，这里要感谢廖雪峰老师的无私分享。</p>
<p><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000" target="_blank" rel="external">廖雪峰的官方网址</a></p>
</blockquote>
<h4 id="杨辉三角："><a href="#杨辉三角：" class="headerlink" title="杨辉三角："></a>杨辉三角：</h4><p>前提：每行端点与结尾的数为1.</p>
<ol>
<li>每个数等于它上方两数之和。</li>
<li>每行数字左右对称，由1开始逐渐变大。</li>
<li>第n行的数字有n项。</li>
<li>第n行数字和为2n-1。</li>
</ol>
<p>还有其他各种特性。</p>
<p>这里我们主要利用第一点的特性来实现该算法。</p>
<ul>
<li><p>先贴代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">triangles</span><span class="params">()</span>:</span></div><div class="line">    L = [<span class="number">1</span>]</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">yield</span> L</div><div class="line">        L = [<span class="number">1</span>] + [L[i] + L[i+<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(L)<span class="number">-1</span>) <span class="keyword">if</span> len(L) &gt;= <span class="number">2</span>]</div><div class="line">        L.append(<span class="number">1</span>)</div><div class="line"></div><div class="line">n = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> t <span class="keyword">in</span> triangles():</div><div class="line">    print(t)</div><div class="line">    n = n + <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> n == <span class="number">6</span>:</div><div class="line">        <span class="keyword">break</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="代码块说明："><a href="#代码块说明：" class="headerlink" title="代码块说明："></a>代码块说明：</h3><ul>
<li><p>def : 这在 Python 中代表一个方法，triangles()就是一个方法，可以在后面的程序用直接调用，如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> t <span class="keyword">in</span> triangles():</div></pre></td></tr></table></figure>
<p>该段直接调用了该方法，跟其他高级语言中调用，是大同小异。</p>
</li>
</ul>
<ul>
<li><p>yield : 带有 yield 的函数在 Python 中被称之为 generator（生成器），生成器的内容就不在此累赘，不了解的同学可以 google 一下。根据我自学过程，统一采用我 google 到的答案进行描述。这里将用如何生成斐波那契數列来进行一系列说明。</p>
<blockquote>
<p>斐波那契(Fibonacci)数列是一个非常简单的递归数列，除了第一个第二个数外，任意一个数都可由两个数相加得到。用计算机程序输出菲波那切数列的前 N 个数是一个非常简单的问题，许多初学者都可以轻易写出如下函数：</p>
</blockquote>
<ul>
<li>方法1:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span></div><div class="line">	n, a, b = <span class="number">0</span>, <span class="number">0</span> ,<span class="number">1</span></div><div class="line">	<span class="keyword">while</span> n &lt; max:</div><div class="line">		print(b)</div><div class="line">		a, b = b, a + b</div><div class="line">		n = n + <span class="number">1</span> </div><div class="line"></div><div class="line"><span class="comment"># 执行fab(5)：</span></div><div class="line">fab(<span class="number">5</span>)</div></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure>
<p>结果没问题，但是这里会有一个问题产生，直接在 fab 函数中用 print 打印数字会导致该函数可复用性较差，因为无法获取该函数生成的数列。</p>
<p>而为了提高 fab 函数的可复用性，最好不要直接打印数列，而是返回一个list.</p>
<ul>
<li>方法2:</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span></div><div class="line">	n, a, b = <span class="number">0</span>, <span class="number">0</span> ,<span class="number">1</span></div><div class="line">	L = []</div><div class="line">	<span class="keyword">while</span> n &lt; max:</div><div class="line">		L.append(b)</div><div class="line">		a, b = b, a + b</div><div class="line">		n = n + <span class="number">1</span> </div><div class="line">	<span class="keyword">return</span> L</div><div class="line"></div><div class="line"><span class="comment"># 执行fab(5)，并循环输出fab(5)</span></div><div class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fab(<span class="number">5</span>):</div><div class="line">	print(n)</div></pre></td></tr></table></figure>
<p>得到结果:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">5</span></div><div class="line"></div><div class="line">***Repl Closed***</div></pre></td></tr></table></figure>
<p>改写后的 fab 函数通过返回的 List 能满足复用性的要求，但是这里又会出现另一个问题，该函数在运行中占用的内存会随着参数 max 的增大而增大，如果要控制内存占用，就最好不要用 List  来保存中间结果，而是用过 iterable 对象来迭代。</p>
<ul>
<li>方法3:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fab</span><span class="params">(object)</span>:</span> </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,max)</span>:</span> </div><div class="line">        self.max = max </div><div class="line">        self.n, self.a, self.b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span> </div><div class="line">        <span class="keyword">return</span> self </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span> </div><div class="line">        <span class="keyword">if</span> self.n &lt; self.max: </div><div class="line">            r = self.b </div><div class="line">            self.a, self.b = self.b, self.a + self.b </div><div class="line">            self.n = self.n + <span class="number">1</span> </div><div class="line">            <span class="keyword">return</span> r</div><div class="line">        <span class="keyword">raise</span> StopIteration()</div><div class="line"></div><div class="line">s = Fab(<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="comment">#通过执行next得到r每次r的值</span></div><div class="line">print(s.next())</div><div class="line">print(s.next())</div><div class="line">print(s.next())</div><div class="line">print(s.next())</div><div class="line">print(s.next())</div><div class="line">print(s.next())<span class="comment">#因为只是Fab(5),所以这是第六次，会终止结果</span></div></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">5</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"fibonacci.py"</span>, line <span class="number">25</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    print(s.next())</div><div class="line">  File <span class="string">"fibonacci.py"</span>, line <span class="number">16</span>, <span class="keyword">in</span> next</div><div class="line">    <span class="keyword">raise</span> StopIteration()</div><div class="line">StopIteration</div><div class="line"></div><div class="line">***Repl Closed***</div></pre></td></tr></table></figure>
<p>然而，使用 calss 改写的这个版本，代码明显没有方法一使用 fab 函数来的简洁。这时候为了保证具有代码的简洁性的同时又可以获得 iterable 的效果，yield 就派上用场了。</p>
<ul>
<li>方法4:</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span></div><div class="line">	n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></div><div class="line">	<span class="keyword">while</span> n &lt; max:</div><div class="line">		<span class="keyword">yield</span> b</div><div class="line">		a, b = b, a + b</div><div class="line">		n = n + <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fab(<span class="number">5</span>):</div><div class="line">	print(n)</div></pre></td></tr></table></figure>
<p>得到:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">5</span></div><div class="line"></div><div class="line">***Repl Closed***</div></pre></td></tr></table></figure>
<p>结果跟上面的方法都是一样的。但是这里仅仅是把 方法一的 print 改成 yield 就实现了代码简洁和获取 iterable 的效果。</p>
<blockquote>
<p>总结：yield 的作用就是把一个函数变成一个 generator(生成器)，带有 yield 的函数也不再是一个简单的函数，Python 解释器会将其视为一个 generator ，调用 fab(5) 不会执行 fab 函数内部的代码，而是返回一个额iterable 对象。</p>
</blockquote>
</li>
<li><p>for i in range(0,len(L)-1) if len(L) &gt;= 2: 这是一个列表生成式(List Conprehensions),是 Python 内置的非常简单却强大的可以用来创建 List 的生产式。举个栗子：要生成 list [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 可以:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">print(list(range(<span class="number">1</span>,<span class="number">11</span>)))</div><div class="line"></div><div class="line">结果：</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</div></pre></td></tr></table></figure>
<p>但是如果要得到一个 [1x1, 2x2, 3x3, …, 10x10] 怎么做呢？不用列表生成器的话就是用循环完成：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">L=[]</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>):</div><div class="line">	L.append(x*x)</div><div class="line"></div><div class="line">print(L)</div><div class="line"></div><div class="line">结果:</div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>, <span class="number">100</span>]</div></pre></td></tr></table></figure>
<p>但是这种循环一看就感觉比较繁琐，而用列表生成式就可以这样使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print([x*x for x in range(1,11)])</div></pre></td></tr></table></figure>
<p>结果和上面循环是一样的，同时我们还可以在后面加上 判断语句，比如现在只输出偶数的结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">print([x*x for x in range(1,11) if x%2==0])</div><div class="line"></div><div class="line">结果:</div><div class="line">[4, 16, 36, 64, 100]</div></pre></td></tr></table></figure>
<p>并且，这里面还可以进行两层循环:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">print([x*y <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>) <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">6</span>) <span class="keyword">if</span> x%<span class="number">2</span>==<span class="number">0</span>])</div><div class="line"></div><div class="line">结果:</div><div class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">16</span>, <span class="number">24</span>, <span class="number">32</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]</div></pre></td></tr></table></figure>
<p>在本次算法中，灵活运用到列表生成式，省去了很多代码，但是同时，代码的可读性变差了，当然熟悉 python 之后这点可读性可以去掉。</p>
<p>​</p>
<h3 id="输出说明"><a href="#输出说明" class="headerlink" title="输出说明"></a>输出说明</h3><p>算法代码片段的后面输出中，因为 L 定义是一个数组，而在 def 中没有加判断终结条件，所以在后面的 for 语句下，加入了 break ，终结代码。</p>
<p>函数 triangles 执行后，在函数 triangles里面包含了很多个 L 数组，使用print(t)  则每次输出一个 L 数组，就会形成所以需要的杨辉三角。</p>
</li>
</ul>
<blockquote>
<p>本次算法学习到此结束。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://chicbian.com/2017/04/01/关于小面/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chicbian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ChicBian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/01/关于小面/" itemprop="url">
                  关于小面
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-01T11:42:49+08:00">
                2017-04-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="说起小面，真的是说不完。"><a href="#说起小面，真的是说不完。" class="headerlink" title="说起小面，真的是说不完。"></a>说起小面，真的是说不完。</h3><p>我想重庆小面在我眼里承载已经不是一碗面，而是一个青春。</p>
<p>在大学之前一直生活在江苏，我妈重庆人，所以从小就养成了喜欢吃麻辣的习惯，无辣不欢。到现在我自己炒菜，只要可以放辣椒的，那就是必须要放的。重点是，我小时候不怎么喜欢吃面，江苏人会做手工面的少，基本都是挂面，偶尔出去吃兰州拉面吧，感觉也不是很正宗。</p>
<p>2012 年，到重庆某大学开始4年的潇洒生活，每天跟寝室的哥几个，上完课讨论吃什么，一般很少说吃米饭的，一般直奔楼下「 老妈抄手 」3 两小面走起，或加个煎蛋，或加点牛肉，或加点肥肠，喜好不一，但是归根到底还都是小面的底子。</p>
<p>2015 年，这家「 老妈抄手 」也关门，按照当时我们哥几个大愚若智来说，估计店面租期到了，不然生意这么好为啥会关门。也是担心了好久，以后附近没啥小面吃了。不巧，隔了不久，楼下又开了家小面店，就叫「 重庆小面 」，当天我们就进去捧场，虽然味道跟以前那家店稍微有点出入，但是终究还是辣个配方，辣个麻辣，辣个爽。</p>
<p>转眼大学 4 年，临近毕业的时候，我去重庆主城实习，当时住蹭住我姐夫租房那边，包住不包吃，好气哦。但是重庆就是有这么一个神奇的地方，基本每隔一个地点，都会有家传承的重庆小面。对于这家小面店，记忆犹新，红油绝对多，辣到你大冬天，坐在外面棚棚下面吃也不觉得冷。有时候我加个煎蛋，老板娘直接把煎蛋放到碗底用红油和面汤泡着，等面吃的差不多，看到下面的煎蛋时候，我筷子一翻转，一口蛋，一口，嗨的不行。基本一周 7 天，我可以去吃 5 天小面。纯小面 3 两才 7 块，加个肉不过  10 块，天大的优惠啊，要吃到饱，吃到撑。</p>
<p>记得实习前有段时间出去面试，中午 11 点的样子，具体位置记不得了。外面大家一人 2 个凳子，就那种塑料凳子，一大一小，大的当桌子用，小的拿来坐，店家面煮好，直接给你端上，你随便找个凳子坐起就是吃。那个碗还不是碗，就直接是一个小铁的瓷盆，大家坐着吃也不显得生疏，估计都是老面客。一边吃面，一边要扯几句重庆话：“今天儿，咋子，咋子？”之类的。</p>
<p>实习的公司楼下也有家面馆，名气比较大，直接标签重庆 100 强。有天早上上班去的比较早，也没在家吃早饭，就坐进去吃了，早饭一般吃 2 两面，6 块钱。价格已经让我觉得很惊讶了，等面上来，一口的韧劲面加麻辣料，惊为天人，大概应该是到那时为止我吃过最好吃的小面。后来就一发不可收拾了，每天早上过去一碗小面，为了不吃到和能吃到面兼得，我都特意早起 3 分钟。有人问，3 分钟确定是早起么，不知道你们在疑惑什么，吃这么好吃的面，需要 3 分钟么，我一般 2 分钟就干掉了，然后慢慢悠悠的走在路上回味。不要怀疑我吃面的速度，除非面很烫，不然 keke 。</p>
<p>就每天这样在吃面的日子中度过，不同是，以前是跟哥几个在学校苍蝇馆子一起吃，现在是自己单独吃。临近毕业，大家终究是要天南海北的分开了。</p>
<p>后来，媳妇来重庆找我玩，又一起去了解放碑那边的一些面馆，吃了好几家，每家都只吃一两面，这样可以多尝试几家，毕竟当初的计划是以后离家近点工作，以后怕是再也吃不到这么好吃的小面了。其中比较推荐的是豆花面，具体名字我也记不得了，标签重庆小面 10 强，在解放碑名气应该挺大，当初吃感觉还挺贵的，12 大洋 2 两面，但是吃完我感觉这面完全是值这个价格的。其中味道，各位以后有机会可以去尝试尝试。</p>
<p>2016 年 6 月 25日 早上 8 点，我起床洗漱，收拾东西，准备离校。当时醒来，寝室就剩了我，胖子，大哥，其余 3 人 菊哥，伯乐，熹哥连铺盖都懒得收拾就滚出了寝室大门。横扫一屋子，阳光顺着窗帘缝隙扫进来，照在了熹哥的臭鞋上。该滚还是得滚啊，尼玛。等我洗漱完毕，拖着箱子打开寝室门，风顺着吹过窗帘，看到胖子也起床下来。今天不知道该如何诉说，我踏出寝室的脚又收回，转身给了胖子一个拥抱。大抵这辈子我们大家也回不去这 4 年了。帮他们关上门，我蹭蹭蹭就跑楼下，拖着箱子慢踏踏的走在路上，我准备再去那家小面吃完面，这次我非常奢侈。我加了蹄花，我还加了煎蛋，毕竟以后也吃不到了，总要吃好点不是。这碗面我吃了多久我记不得了，大抵是我吃完，楞了许久，鬼使神差的一句：“老板，收钱！”就结束了我跟小面的不舍，跟大家的不舍。</p>
<p><em>本该，当初毕业离校就该留下的思念，写到了小面中，感谢小面，丰富了我的味蕾，也丰富我的生活。</em></p>
<p><img src="http://ww1.sinaimg.cn/large/dcc3cfcdgy1fe75azhozvj236o1sinpe.jpg" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  

          
          </div>
          


           

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="chicbian" />
          <p class="site-author-name" itemprop="name">chicbian</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chicbian</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  



  




	





  





    
      
    

   
  


  




  
  

  

  

  

  


  

</body>
</html>
